<!DOCTYPE html><html lang="en-US"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 5.14.1"/><meta name="theme-color" content="#EEE"/><meta data-react-helmet="true" name="icon" href="./images/favicon.png"/><meta data-react-helmet="true" name="keywords" content="microservices, message queue, message queues, rabbitmq, node, node.js, docker, docker-compose, Dakshraj Sharma, Dakshraj, software, softeware engineer, India, Developer, sharmarajdaksh"/><meta data-react-helmet="true" name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=0.9"/><meta data-react-helmet="true" name="description" content="If you have ever heard of message queues like Apache Kafka and been confused about the what, why and how of messaging queues in modern applications, this one is for you."/><meta data-react-helmet="true" property="og:title" content="The what, why, and how of Message Queues"/><meta data-react-helmet="true" property="og:description" content="If you have ever heard of message queues like Apache Kafka and been confused about the what, why and how of messaging queues in modern applications, this one is for you."/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="image" property="og:image" content="https://sharmarajdak.sh/og_dakshraj_sharma.png"/><meta data-react-helmet="true" property="og:url" content="https://sharmarajdak.sh/blog/the-what-why-and-how-of-message-queues/"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:image" content="https://sharmarajdak.sh/og_dakshraj_sharma.png"/><meta data-react-helmet="true" name="twitter:creator" content="If you have ever heard of message queues like Apache Kafka and been confused about the what, why and how of messaging queues in modern applications, this one is for you."/><meta data-react-helmet="true" name="twitter:title" content="The what, why, and how of Message Queues"/><meta data-react-helmet="true" name="twitter:description" content="If you have ever heard of message queues like Apache Kafka and been confused about the what, why and how of messaging queues in modern applications, this one is for you."/><meta data-react-helmet="true" name="author" content="Dakshraj Sharma"/><style data-href="/styles.266c4306c51d587c8340.css" data-identity="gatsby-global-css">a,abbr,acronym,address,applet,article,aside,audio,b,big,blockquote,body,canvas,caption,center,cite,code,dd,del,details,dfn,div,dl,dt,em,embed,fieldset,figcaption,figure,footer,form,h1,h2,h3,h4,h5,h6,header,hgroup,html,i,iframe,img,ins,kbd,label,legend,li,mark,menu,nav,object,ol,output,p,pre,q,ruby,s,samp,section,small,span,strike,strong,sub,summary,sup,table,tbody,td,tfoot,th,thead,time,tr,tt,u,ul,var,video{border:0;font-size:100%;font:inherit;margin:0;padding:0;vertical-align:baseline}article,aside,details,figcaption,figure,footer,header,hgroup,menu,nav,section{display:block}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:after,blockquote:before,q:after,q:before{content:"";content:none}table{border-collapse:collapse;border-spacing:0}a{color:inherit;font-size:inherit;text-decoration:none}*,body,html{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;text-rendering:optimizeLegibility;box-sizing:border-box!important;font-display:swap;font-family:Lato,Segoe UI,Tahoma,Geneva,Verdana,sans-serif}body *{-ms-overflow-style:none;scrollbar-width:none}body ::-webkit-scrollbar{display:none}.blackBG{background-color:#000}.whiteBG{background-color:#eee}.gatsby-resp-image-wrapper{display:block!important;margin-bottom:8%!important;margin-top:8%!important;position:relative!important;z-index:0!important}.gatsby-resp-image-image{z-index:0!important}[data-aos][data-aos][data-aos-duration="50"],body[data-aos-duration="50"] [data-aos]{transition-duration:50ms}[data-aos][data-aos][data-aos-delay="50"],body[data-aos-delay="50"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="50"].aos-animate,body[data-aos-delay="50"] [data-aos].aos-animate{transition-delay:50ms}[data-aos][data-aos][data-aos-duration="100"],body[data-aos-duration="100"] [data-aos]{transition-duration:.1s}[data-aos][data-aos][data-aos-delay="100"],body[data-aos-delay="100"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="100"].aos-animate,body[data-aos-delay="100"] [data-aos].aos-animate{transition-delay:.1s}[data-aos][data-aos][data-aos-duration="150"],body[data-aos-duration="150"] [data-aos]{transition-duration:.15s}[data-aos][data-aos][data-aos-delay="150"],body[data-aos-delay="150"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="150"].aos-animate,body[data-aos-delay="150"] [data-aos].aos-animate{transition-delay:.15s}[data-aos][data-aos][data-aos-duration="200"],body[data-aos-duration="200"] [data-aos]{transition-duration:.2s}[data-aos][data-aos][data-aos-delay="200"],body[data-aos-delay="200"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="200"].aos-animate,body[data-aos-delay="200"] [data-aos].aos-animate{transition-delay:.2s}[data-aos][data-aos][data-aos-duration="250"],body[data-aos-duration="250"] [data-aos]{transition-duration:.25s}[data-aos][data-aos][data-aos-delay="250"],body[data-aos-delay="250"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="250"].aos-animate,body[data-aos-delay="250"] [data-aos].aos-animate{transition-delay:.25s}[data-aos][data-aos][data-aos-duration="300"],body[data-aos-duration="300"] [data-aos]{transition-duration:.3s}[data-aos][data-aos][data-aos-delay="300"],body[data-aos-delay="300"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="300"].aos-animate,body[data-aos-delay="300"] [data-aos].aos-animate{transition-delay:.3s}[data-aos][data-aos][data-aos-duration="350"],body[data-aos-duration="350"] [data-aos]{transition-duration:.35s}[data-aos][data-aos][data-aos-delay="350"],body[data-aos-delay="350"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="350"].aos-animate,body[data-aos-delay="350"] [data-aos].aos-animate{transition-delay:.35s}[data-aos][data-aos][data-aos-duration="400"],body[data-aos-duration="400"] [data-aos]{transition-duration:.4s}[data-aos][data-aos][data-aos-delay="400"],body[data-aos-delay="400"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="400"].aos-animate,body[data-aos-delay="400"] [data-aos].aos-animate{transition-delay:.4s}[data-aos][data-aos][data-aos-duration="450"],body[data-aos-duration="450"] [data-aos]{transition-duration:.45s}[data-aos][data-aos][data-aos-delay="450"],body[data-aos-delay="450"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="450"].aos-animate,body[data-aos-delay="450"] [data-aos].aos-animate{transition-delay:.45s}[data-aos][data-aos][data-aos-duration="500"],body[data-aos-duration="500"] [data-aos]{transition-duration:.5s}[data-aos][data-aos][data-aos-delay="500"],body[data-aos-delay="500"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="500"].aos-animate,body[data-aos-delay="500"] [data-aos].aos-animate{transition-delay:.5s}[data-aos][data-aos][data-aos-duration="550"],body[data-aos-duration="550"] [data-aos]{transition-duration:.55s}[data-aos][data-aos][data-aos-delay="550"],body[data-aos-delay="550"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="550"].aos-animate,body[data-aos-delay="550"] [data-aos].aos-animate{transition-delay:.55s}[data-aos][data-aos][data-aos-duration="600"],body[data-aos-duration="600"] [data-aos]{transition-duration:.6s}[data-aos][data-aos][data-aos-delay="600"],body[data-aos-delay="600"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="600"].aos-animate,body[data-aos-delay="600"] [data-aos].aos-animate{transition-delay:.6s}[data-aos][data-aos][data-aos-duration="650"],body[data-aos-duration="650"] [data-aos]{transition-duration:.65s}[data-aos][data-aos][data-aos-delay="650"],body[data-aos-delay="650"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="650"].aos-animate,body[data-aos-delay="650"] [data-aos].aos-animate{transition-delay:.65s}[data-aos][data-aos][data-aos-duration="700"],body[data-aos-duration="700"] [data-aos]{transition-duration:.7s}[data-aos][data-aos][data-aos-delay="700"],body[data-aos-delay="700"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="700"].aos-animate,body[data-aos-delay="700"] [data-aos].aos-animate{transition-delay:.7s}[data-aos][data-aos][data-aos-duration="750"],body[data-aos-duration="750"] [data-aos]{transition-duration:.75s}[data-aos][data-aos][data-aos-delay="750"],body[data-aos-delay="750"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="750"].aos-animate,body[data-aos-delay="750"] [data-aos].aos-animate{transition-delay:.75s}[data-aos][data-aos][data-aos-duration="800"],body[data-aos-duration="800"] [data-aos]{transition-duration:.8s}[data-aos][data-aos][data-aos-delay="800"],body[data-aos-delay="800"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="800"].aos-animate,body[data-aos-delay="800"] [data-aos].aos-animate{transition-delay:.8s}[data-aos][data-aos][data-aos-duration="850"],body[data-aos-duration="850"] [data-aos]{transition-duration:.85s}[data-aos][data-aos][data-aos-delay="850"],body[data-aos-delay="850"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="850"].aos-animate,body[data-aos-delay="850"] [data-aos].aos-animate{transition-delay:.85s}[data-aos][data-aos][data-aos-duration="900"],body[data-aos-duration="900"] [data-aos]{transition-duration:.9s}[data-aos][data-aos][data-aos-delay="900"],body[data-aos-delay="900"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="900"].aos-animate,body[data-aos-delay="900"] [data-aos].aos-animate{transition-delay:.9s}[data-aos][data-aos][data-aos-duration="950"],body[data-aos-duration="950"] [data-aos]{transition-duration:.95s}[data-aos][data-aos][data-aos-delay="950"],body[data-aos-delay="950"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="950"].aos-animate,body[data-aos-delay="950"] [data-aos].aos-animate{transition-delay:.95s}[data-aos][data-aos][data-aos-duration="1000"],body[data-aos-duration="1000"] [data-aos]{transition-duration:1s}[data-aos][data-aos][data-aos-delay="1000"],body[data-aos-delay="1000"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1000"].aos-animate,body[data-aos-delay="1000"] [data-aos].aos-animate{transition-delay:1s}[data-aos][data-aos][data-aos-duration="1050"],body[data-aos-duration="1050"] [data-aos]{transition-duration:1.05s}[data-aos][data-aos][data-aos-delay="1050"],body[data-aos-delay="1050"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1050"].aos-animate,body[data-aos-delay="1050"] [data-aos].aos-animate{transition-delay:1.05s}[data-aos][data-aos][data-aos-duration="1100"],body[data-aos-duration="1100"] [data-aos]{transition-duration:1.1s}[data-aos][data-aos][data-aos-delay="1100"],body[data-aos-delay="1100"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1100"].aos-animate,body[data-aos-delay="1100"] [data-aos].aos-animate{transition-delay:1.1s}[data-aos][data-aos][data-aos-duration="1150"],body[data-aos-duration="1150"] [data-aos]{transition-duration:1.15s}[data-aos][data-aos][data-aos-delay="1150"],body[data-aos-delay="1150"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1150"].aos-animate,body[data-aos-delay="1150"] [data-aos].aos-animate{transition-delay:1.15s}[data-aos][data-aos][data-aos-duration="1200"],body[data-aos-duration="1200"] [data-aos]{transition-duration:1.2s}[data-aos][data-aos][data-aos-delay="1200"],body[data-aos-delay="1200"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1200"].aos-animate,body[data-aos-delay="1200"] [data-aos].aos-animate{transition-delay:1.2s}[data-aos][data-aos][data-aos-duration="1250"],body[data-aos-duration="1250"] [data-aos]{transition-duration:1.25s}[data-aos][data-aos][data-aos-delay="1250"],body[data-aos-delay="1250"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1250"].aos-animate,body[data-aos-delay="1250"] [data-aos].aos-animate{transition-delay:1.25s}[data-aos][data-aos][data-aos-duration="1300"],body[data-aos-duration="1300"] [data-aos]{transition-duration:1.3s}[data-aos][data-aos][data-aos-delay="1300"],body[data-aos-delay="1300"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1300"].aos-animate,body[data-aos-delay="1300"] [data-aos].aos-animate{transition-delay:1.3s}[data-aos][data-aos][data-aos-duration="1350"],body[data-aos-duration="1350"] [data-aos]{transition-duration:1.35s}[data-aos][data-aos][data-aos-delay="1350"],body[data-aos-delay="1350"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1350"].aos-animate,body[data-aos-delay="1350"] [data-aos].aos-animate{transition-delay:1.35s}[data-aos][data-aos][data-aos-duration="1400"],body[data-aos-duration="1400"] [data-aos]{transition-duration:1.4s}[data-aos][data-aos][data-aos-delay="1400"],body[data-aos-delay="1400"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1400"].aos-animate,body[data-aos-delay="1400"] [data-aos].aos-animate{transition-delay:1.4s}[data-aos][data-aos][data-aos-duration="1450"],body[data-aos-duration="1450"] [data-aos]{transition-duration:1.45s}[data-aos][data-aos][data-aos-delay="1450"],body[data-aos-delay="1450"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1450"].aos-animate,body[data-aos-delay="1450"] [data-aos].aos-animate{transition-delay:1.45s}[data-aos][data-aos][data-aos-duration="1500"],body[data-aos-duration="1500"] [data-aos]{transition-duration:1.5s}[data-aos][data-aos][data-aos-delay="1500"],body[data-aos-delay="1500"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1500"].aos-animate,body[data-aos-delay="1500"] [data-aos].aos-animate{transition-delay:1.5s}[data-aos][data-aos][data-aos-duration="1550"],body[data-aos-duration="1550"] [data-aos]{transition-duration:1.55s}[data-aos][data-aos][data-aos-delay="1550"],body[data-aos-delay="1550"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1550"].aos-animate,body[data-aos-delay="1550"] [data-aos].aos-animate{transition-delay:1.55s}[data-aos][data-aos][data-aos-duration="1600"],body[data-aos-duration="1600"] [data-aos]{transition-duration:1.6s}[data-aos][data-aos][data-aos-delay="1600"],body[data-aos-delay="1600"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1600"].aos-animate,body[data-aos-delay="1600"] [data-aos].aos-animate{transition-delay:1.6s}[data-aos][data-aos][data-aos-duration="1650"],body[data-aos-duration="1650"] [data-aos]{transition-duration:1.65s}[data-aos][data-aos][data-aos-delay="1650"],body[data-aos-delay="1650"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1650"].aos-animate,body[data-aos-delay="1650"] [data-aos].aos-animate{transition-delay:1.65s}[data-aos][data-aos][data-aos-duration="1700"],body[data-aos-duration="1700"] [data-aos]{transition-duration:1.7s}[data-aos][data-aos][data-aos-delay="1700"],body[data-aos-delay="1700"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1700"].aos-animate,body[data-aos-delay="1700"] [data-aos].aos-animate{transition-delay:1.7s}[data-aos][data-aos][data-aos-duration="1750"],body[data-aos-duration="1750"] [data-aos]{transition-duration:1.75s}[data-aos][data-aos][data-aos-delay="1750"],body[data-aos-delay="1750"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1750"].aos-animate,body[data-aos-delay="1750"] [data-aos].aos-animate{transition-delay:1.75s}[data-aos][data-aos][data-aos-duration="1800"],body[data-aos-duration="1800"] [data-aos]{transition-duration:1.8s}[data-aos][data-aos][data-aos-delay="1800"],body[data-aos-delay="1800"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1800"].aos-animate,body[data-aos-delay="1800"] [data-aos].aos-animate{transition-delay:1.8s}[data-aos][data-aos][data-aos-duration="1850"],body[data-aos-duration="1850"] [data-aos]{transition-duration:1.85s}[data-aos][data-aos][data-aos-delay="1850"],body[data-aos-delay="1850"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1850"].aos-animate,body[data-aos-delay="1850"] [data-aos].aos-animate{transition-delay:1.85s}[data-aos][data-aos][data-aos-duration="1900"],body[data-aos-duration="1900"] [data-aos]{transition-duration:1.9s}[data-aos][data-aos][data-aos-delay="1900"],body[data-aos-delay="1900"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1900"].aos-animate,body[data-aos-delay="1900"] [data-aos].aos-animate{transition-delay:1.9s}[data-aos][data-aos][data-aos-duration="1950"],body[data-aos-duration="1950"] [data-aos]{transition-duration:1.95s}[data-aos][data-aos][data-aos-delay="1950"],body[data-aos-delay="1950"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="1950"].aos-animate,body[data-aos-delay="1950"] [data-aos].aos-animate{transition-delay:1.95s}[data-aos][data-aos][data-aos-duration="2000"],body[data-aos-duration="2000"] [data-aos]{transition-duration:2s}[data-aos][data-aos][data-aos-delay="2000"],body[data-aos-delay="2000"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2000"].aos-animate,body[data-aos-delay="2000"] [data-aos].aos-animate{transition-delay:2s}[data-aos][data-aos][data-aos-duration="2050"],body[data-aos-duration="2050"] [data-aos]{transition-duration:2.05s}[data-aos][data-aos][data-aos-delay="2050"],body[data-aos-delay="2050"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2050"].aos-animate,body[data-aos-delay="2050"] [data-aos].aos-animate{transition-delay:2.05s}[data-aos][data-aos][data-aos-duration="2100"],body[data-aos-duration="2100"] [data-aos]{transition-duration:2.1s}[data-aos][data-aos][data-aos-delay="2100"],body[data-aos-delay="2100"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2100"].aos-animate,body[data-aos-delay="2100"] [data-aos].aos-animate{transition-delay:2.1s}[data-aos][data-aos][data-aos-duration="2150"],body[data-aos-duration="2150"] [data-aos]{transition-duration:2.15s}[data-aos][data-aos][data-aos-delay="2150"],body[data-aos-delay="2150"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2150"].aos-animate,body[data-aos-delay="2150"] [data-aos].aos-animate{transition-delay:2.15s}[data-aos][data-aos][data-aos-duration="2200"],body[data-aos-duration="2200"] [data-aos]{transition-duration:2.2s}[data-aos][data-aos][data-aos-delay="2200"],body[data-aos-delay="2200"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2200"].aos-animate,body[data-aos-delay="2200"] [data-aos].aos-animate{transition-delay:2.2s}[data-aos][data-aos][data-aos-duration="2250"],body[data-aos-duration="2250"] [data-aos]{transition-duration:2.25s}[data-aos][data-aos][data-aos-delay="2250"],body[data-aos-delay="2250"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2250"].aos-animate,body[data-aos-delay="2250"] [data-aos].aos-animate{transition-delay:2.25s}[data-aos][data-aos][data-aos-duration="2300"],body[data-aos-duration="2300"] [data-aos]{transition-duration:2.3s}[data-aos][data-aos][data-aos-delay="2300"],body[data-aos-delay="2300"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2300"].aos-animate,body[data-aos-delay="2300"] [data-aos].aos-animate{transition-delay:2.3s}[data-aos][data-aos][data-aos-duration="2350"],body[data-aos-duration="2350"] [data-aos]{transition-duration:2.35s}[data-aos][data-aos][data-aos-delay="2350"],body[data-aos-delay="2350"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2350"].aos-animate,body[data-aos-delay="2350"] [data-aos].aos-animate{transition-delay:2.35s}[data-aos][data-aos][data-aos-duration="2400"],body[data-aos-duration="2400"] [data-aos]{transition-duration:2.4s}[data-aos][data-aos][data-aos-delay="2400"],body[data-aos-delay="2400"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2400"].aos-animate,body[data-aos-delay="2400"] [data-aos].aos-animate{transition-delay:2.4s}[data-aos][data-aos][data-aos-duration="2450"],body[data-aos-duration="2450"] [data-aos]{transition-duration:2.45s}[data-aos][data-aos][data-aos-delay="2450"],body[data-aos-delay="2450"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2450"].aos-animate,body[data-aos-delay="2450"] [data-aos].aos-animate{transition-delay:2.45s}[data-aos][data-aos][data-aos-duration="2500"],body[data-aos-duration="2500"] [data-aos]{transition-duration:2.5s}[data-aos][data-aos][data-aos-delay="2500"],body[data-aos-delay="2500"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2500"].aos-animate,body[data-aos-delay="2500"] [data-aos].aos-animate{transition-delay:2.5s}[data-aos][data-aos][data-aos-duration="2550"],body[data-aos-duration="2550"] [data-aos]{transition-duration:2.55s}[data-aos][data-aos][data-aos-delay="2550"],body[data-aos-delay="2550"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2550"].aos-animate,body[data-aos-delay="2550"] [data-aos].aos-animate{transition-delay:2.55s}[data-aos][data-aos][data-aos-duration="2600"],body[data-aos-duration="2600"] [data-aos]{transition-duration:2.6s}[data-aos][data-aos][data-aos-delay="2600"],body[data-aos-delay="2600"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2600"].aos-animate,body[data-aos-delay="2600"] [data-aos].aos-animate{transition-delay:2.6s}[data-aos][data-aos][data-aos-duration="2650"],body[data-aos-duration="2650"] [data-aos]{transition-duration:2.65s}[data-aos][data-aos][data-aos-delay="2650"],body[data-aos-delay="2650"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2650"].aos-animate,body[data-aos-delay="2650"] [data-aos].aos-animate{transition-delay:2.65s}[data-aos][data-aos][data-aos-duration="2700"],body[data-aos-duration="2700"] [data-aos]{transition-duration:2.7s}[data-aos][data-aos][data-aos-delay="2700"],body[data-aos-delay="2700"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2700"].aos-animate,body[data-aos-delay="2700"] [data-aos].aos-animate{transition-delay:2.7s}[data-aos][data-aos][data-aos-duration="2750"],body[data-aos-duration="2750"] [data-aos]{transition-duration:2.75s}[data-aos][data-aos][data-aos-delay="2750"],body[data-aos-delay="2750"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2750"].aos-animate,body[data-aos-delay="2750"] [data-aos].aos-animate{transition-delay:2.75s}[data-aos][data-aos][data-aos-duration="2800"],body[data-aos-duration="2800"] [data-aos]{transition-duration:2.8s}[data-aos][data-aos][data-aos-delay="2800"],body[data-aos-delay="2800"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2800"].aos-animate,body[data-aos-delay="2800"] [data-aos].aos-animate{transition-delay:2.8s}[data-aos][data-aos][data-aos-duration="2850"],body[data-aos-duration="2850"] [data-aos]{transition-duration:2.85s}[data-aos][data-aos][data-aos-delay="2850"],body[data-aos-delay="2850"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2850"].aos-animate,body[data-aos-delay="2850"] [data-aos].aos-animate{transition-delay:2.85s}[data-aos][data-aos][data-aos-duration="2900"],body[data-aos-duration="2900"] [data-aos]{transition-duration:2.9s}[data-aos][data-aos][data-aos-delay="2900"],body[data-aos-delay="2900"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2900"].aos-animate,body[data-aos-delay="2900"] [data-aos].aos-animate{transition-delay:2.9s}[data-aos][data-aos][data-aos-duration="2950"],body[data-aos-duration="2950"] [data-aos]{transition-duration:2.95s}[data-aos][data-aos][data-aos-delay="2950"],body[data-aos-delay="2950"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="2950"].aos-animate,body[data-aos-delay="2950"] [data-aos].aos-animate{transition-delay:2.95s}[data-aos][data-aos][data-aos-duration="3000"],body[data-aos-duration="3000"] [data-aos]{transition-duration:3s}[data-aos][data-aos][data-aos-delay="3000"],body[data-aos-delay="3000"] [data-aos]{transition-delay:0}[data-aos][data-aos][data-aos-delay="3000"].aos-animate,body[data-aos-delay="3000"] [data-aos].aos-animate{transition-delay:3s}[data-aos][data-aos][data-aos-easing=linear],body[data-aos-easing=linear] [data-aos]{transition-timing-function:cubic-bezier(.25,.25,.75,.75)}[data-aos][data-aos][data-aos-easing=ease],body[data-aos-easing=ease] [data-aos]{transition-timing-function:ease}[data-aos][data-aos][data-aos-easing=ease-in],body[data-aos-easing=ease-in] [data-aos]{transition-timing-function:ease-in}[data-aos][data-aos][data-aos-easing=ease-out],body[data-aos-easing=ease-out] [data-aos]{transition-timing-function:ease-out}[data-aos][data-aos][data-aos-easing=ease-in-out],body[data-aos-easing=ease-in-out] [data-aos]{transition-timing-function:ease-in-out}[data-aos][data-aos][data-aos-easing=ease-in-back],body[data-aos-easing=ease-in-back] [data-aos]{transition-timing-function:cubic-bezier(.6,-.28,.735,.045)}[data-aos][data-aos][data-aos-easing=ease-out-back],body[data-aos-easing=ease-out-back] [data-aos]{transition-timing-function:cubic-bezier(.175,.885,.32,1.275)}[data-aos][data-aos][data-aos-easing=ease-in-out-back],body[data-aos-easing=ease-in-out-back] [data-aos]{transition-timing-function:cubic-bezier(.68,-.55,.265,1.55)}[data-aos][data-aos][data-aos-easing=ease-in-sine],body[data-aos-easing=ease-in-sine] [data-aos]{transition-timing-function:cubic-bezier(.47,0,.745,.715)}[data-aos][data-aos][data-aos-easing=ease-out-sine],body[data-aos-easing=ease-out-sine] [data-aos]{transition-timing-function:cubic-bezier(.39,.575,.565,1)}[data-aos][data-aos][data-aos-easing=ease-in-out-sine],body[data-aos-easing=ease-in-out-sine] [data-aos]{transition-timing-function:cubic-bezier(.445,.05,.55,.95)}[data-aos][data-aos][data-aos-easing=ease-in-quad],body[data-aos-easing=ease-in-quad] [data-aos]{transition-timing-function:cubic-bezier(.55,.085,.68,.53)}[data-aos][data-aos][data-aos-easing=ease-out-quad],body[data-aos-easing=ease-out-quad] [data-aos]{transition-timing-function:cubic-bezier(.25,.46,.45,.94)}[data-aos][data-aos][data-aos-easing=ease-in-out-quad],body[data-aos-easing=ease-in-out-quad] [data-aos]{transition-timing-function:cubic-bezier(.455,.03,.515,.955)}[data-aos][data-aos][data-aos-easing=ease-in-cubic],body[data-aos-easing=ease-in-cubic] [data-aos]{transition-timing-function:cubic-bezier(.55,.085,.68,.53)}[data-aos][data-aos][data-aos-easing=ease-out-cubic],body[data-aos-easing=ease-out-cubic] [data-aos]{transition-timing-function:cubic-bezier(.25,.46,.45,.94)}[data-aos][data-aos][data-aos-easing=ease-in-out-cubic],body[data-aos-easing=ease-in-out-cubic] [data-aos]{transition-timing-function:cubic-bezier(.455,.03,.515,.955)}[data-aos][data-aos][data-aos-easing=ease-in-quart],body[data-aos-easing=ease-in-quart] [data-aos]{transition-timing-function:cubic-bezier(.55,.085,.68,.53)}[data-aos][data-aos][data-aos-easing=ease-out-quart],body[data-aos-easing=ease-out-quart] [data-aos]{transition-timing-function:cubic-bezier(.25,.46,.45,.94)}[data-aos][data-aos][data-aos-easing=ease-in-out-quart],body[data-aos-easing=ease-in-out-quart] [data-aos]{transition-timing-function:cubic-bezier(.455,.03,.515,.955)}[data-aos^=fade][data-aos^=fade]{opacity:0;transition-property:opacity,transform}[data-aos^=fade][data-aos^=fade].aos-animate{opacity:1;transform:translateZ(0)}[data-aos=fade-up]{transform:translate3d(0,100px,0)}[data-aos=fade-down]{transform:translate3d(0,-100px,0)}[data-aos=fade-right]{transform:translate3d(-100px,0,0)}[data-aos=fade-left]{transform:translate3d(100px,0,0)}[data-aos=fade-up-right]{transform:translate3d(-100px,100px,0)}[data-aos=fade-up-left]{transform:translate3d(100px,100px,0)}[data-aos=fade-down-right]{transform:translate3d(-100px,-100px,0)}[data-aos=fade-down-left]{transform:translate3d(100px,-100px,0)}[data-aos^=zoom][data-aos^=zoom]{opacity:0;transition-property:opacity,transform}[data-aos^=zoom][data-aos^=zoom].aos-animate{opacity:1;transform:translateZ(0) scale(1)}[data-aos=zoom-in]{transform:scale(.6)}[data-aos=zoom-in-up]{transform:translate3d(0,100px,0) scale(.6)}[data-aos=zoom-in-down]{transform:translate3d(0,-100px,0) scale(.6)}[data-aos=zoom-in-right]{transform:translate3d(-100px,0,0) scale(.6)}[data-aos=zoom-in-left]{transform:translate3d(100px,0,0) scale(.6)}[data-aos=zoom-out]{transform:scale(1.2)}[data-aos=zoom-out-up]{transform:translate3d(0,100px,0) scale(1.2)}[data-aos=zoom-out-down]{transform:translate3d(0,-100px,0) scale(1.2)}[data-aos=zoom-out-right]{transform:translate3d(-100px,0,0) scale(1.2)}[data-aos=zoom-out-left]{transform:translate3d(100px,0,0) scale(1.2)}[data-aos^=slide][data-aos^=slide]{transition-property:transform}[data-aos^=slide][data-aos^=slide].aos-animate{transform:translateZ(0)}[data-aos=slide-up]{transform:translate3d(0,100%,0)}[data-aos=slide-down]{transform:translate3d(0,-100%,0)}[data-aos=slide-right]{transform:translate3d(-100%,0,0)}[data-aos=slide-left]{transform:translate3d(100%,0,0)}[data-aos^=flip][data-aos^=flip]{-webkit-backface-visibility:hidden;backface-visibility:hidden;transition-property:transform}[data-aos=flip-left]{transform:perspective(2500px) rotateY(-100deg)}[data-aos=flip-left].aos-animate{transform:perspective(2500px) rotateY(0)}[data-aos=flip-right]{transform:perspective(2500px) rotateY(100deg)}[data-aos=flip-right].aos-animate{transform:perspective(2500px) rotateY(0)}[data-aos=flip-up]{transform:perspective(2500px) rotateX(-100deg)}[data-aos=flip-up].aos-animate{transform:perspective(2500px) rotateX(0)}[data-aos=flip-down]{transform:perspective(2500px) rotateX(100deg)}[data-aos=flip-down].aos-animate{transform:perspective(2500px) rotateX(0)}.Aside-module--awiggleup--fc910 svg{transition:transform .25s cubic-bezier(.645,.045,.355,1) 0s}.Aside-module--awiggleup--fc910:hover svg{transform:translateY(-.25rem)}@keyframes Aside-module--slideup--2953c{0%{transform:translateY(0)}to{opacity:1;transform:translateY(-40px)}}@keyframes Aside-module--fadein--76d7e{0%{opacity:0}to{opacity:1}}.Aside-module--aside__shell--3fbae{align-items:center;background:#000;color:#aaa;display:flex;flex-flow:column;font-weight:700;height:100%;justify-content:flex-end;position:fixed;transition:background .25s,color .25s;width:100px}.Aside-module--aside__shell--3fbae .Aside-module--aside__element--f68e4{cursor:pointer;font-size:1.5rem;margin-bottom:2rem;max-width:1.5rem}.Aside-module--aside__shell--3fbae .Aside-module--aside__element--f68e4 a{color:inherit}.Aside-module--aside__shell--3fbae .Aside-module--aside__element--f68e4 button{background-color:transparent;border:none;color:inherit;cursor:pointer;font-size:inherit;margin:0;outline:none;padding:0}.Aside-module--aside__shell--3fbae .Aside-module--aside__verticalline--53555{background-color:#aaa;height:20vh;width:2px}@media only screen and (max-height:750px){.Aside-module--aside__shell--3fbae .Aside-module--aside__verticalline--53555{height:0}}.Aside-module--aside__shell--3fbae .Aside-module--glowonhover--b69fd:hover{color:#eee;transition:color .25s}.Aside-module--aside__shell--3fbae .Aside-module--aside__email--edda5 a{text-decoration:none}@media(max-width:900px){.Aside-module--aside__shell--3fbae{background-color:#000;bottom:0;color:#eee;display:flex;flex-flow:row;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content;justify-content:flex-end;max-height:50px;max-width:100vw;overflow:hidden;padding:1rem 0 1rem 1rem;position:-webkit-sticky;position:sticky;width:100%;z-index:99}.Aside-module--aside__shell--3fbae .Aside-module--aside__verticalline--53555{flex:1 1;height:2px;padding-right:0}.Aside-module--aside__shell--3fbae .Aside-module--aside__element--f68e4{cursor:pointer;font-size:1.3rem;margin-bottom:0;margin-right:1.4rem}.Aside-module--aside__shell--3fbae .Aside-module--aside__element--f68e4 button{vertical-align:baseline}}.Aside-module--aside__shellLight--c6f46{background:#eee;color:#666}.Aside-module--aside__shellLight--c6f46 .Aside-module--glowonhoverLight--091a2:hover{color:#111;transition:color .25s}.Aside-module--aside__shellLight--c6f46 .Aside-module--aside__verticalline--53555{background-color:#555}.Navbar-module--navbar__shell--1f077{color:#bbb;display:flex;flex-flow:row-reverse;padding-right:1rem;padding-top:1rem;position:fixed;right:0;transition:background .25s,color .25s;z-index:1000000}.Navbar-module--navbar__shell--1f077 ul{display:flex;flex-direction:row;font-size:1rem;padding-top:1rem}.Navbar-module--navbar__shell--1f077 ul li{cursor:pointer;font-kerning:normal;font-weight:700;letter-spacing:.025rem;margin-right:1rem;transition:all .25s}.Navbar-module--navbar__shell--1f077 ul li:hover{color:#eee}@media(max-width:900px){.Navbar-module--navbar__shell--1f077{color:#eee;padding-right:.5rem;padding-top:.5rem}.Navbar-module--navbar__shell--1f077 ul{font-size:.9rem}}.Navbar-module--navbar__shellLight--83233{color:#555}.Navbar-module--navbar__shellLight--83233 ul>li:hover{color:#222}.index-module--page__shell--cc2b2{background-color:#000;display:flex;max-width:100vw}@media(max-width:900px){.index-module--page__shell--cc2b2{flex-flow:column-reverse;justify-content:flex-end}}.index-module--page__shellLight--60f33{background-color:#eee}.Blog-module--landing--b9d64{flex:1 1;line-height:1.1;min-height:100vh;padding-left:150px;padding-right:150px;padding-top:2rem}.Blog-module--landing--b9d64 .Blog-module--preText--dd4ca{font-size:1.5rem}.Blog-module--landing--b9d64 .Blog-module--name--330c9{font-size:4rem;font-weight:900;margin-bottom:.5rem}.Blog-module--landing--b9d64 .Blog-module--titlesection--7b699{margin:auto auto 4rem}.Blog-module--landing--b9d64 .Blog-module--divider--4f8db{background-color:#777;height:1px;max-width:650px;width:70%}.Blog-module--landing--b9d64 .Blog-module--dividerFooter--7a4af{background-color:#777;height:1px;margin:auto;max-width:650px;width:70%}.Blog-module--landing--b9d64 .Blog-module--postslist--d318d{margin:auto;max-width:650px;width:80%}.Blog-module--landing--b9d64 .Blog-module--bloglist__item--5da32{padding-bottom:3rem;padding-top:3rem}.Blog-module--landing--b9d64 .Blog-module--bloglist__title--3941a{font-size:1.5rem;font-weight:700;line-height:1.5}.Blog-module--landing--b9d64 .Blog-module--bloglist__author--454b0{font-size:.85rem;margin-bottom:2%;margin-top:1.5%}.Blog-module--landing--b9d64 .Blog-module--bloglist__content--103f6{font-size:1rem;line-height:1.5;margin-top:2%}.Blog-module--landing--b9d64 footer{font-size:.8rem;margin-bottom:5%;margin-top:5%;overflow-y:hidden;text-align:center}.Blog-module--landing--b9d64 .Blog-module--blogpost__content--da07b{font-size:1rem;line-height:1.2;margin:auto;max-width:650px;padding-bottom:4rem;padding-top:3rem;width:80%}.Blog-module--landing--b9d64 .Blog-module--blogpost__title--b267b{font-size:2rem;font-weight:700;line-height:1.25}.Blog-module--landing--b9d64 .Blog-module--blogpost__subtitle--7beb8{font-size:1.2rem;font-weight:700;line-height:1.25;margin-bottom:3%;margin-top:3%}.Blog-module--landing--b9d64 .Blog-module--blogpost__author--8b1e2{font-size:1rem;margin-bottom:4%}.Blog-module--landing--b9d64 .Blog-module--blogpost__header--95f0b{margin-bottom:8%}.Blog-module--landing--b9d64 .Blog-module--backToTop--f0b20{bottom:1rem;color:#999;font-size:2rem;position:fixed;right:1rem;transition:all 1s;-webkit-transition:all 1s;-moz-transition:all 1s;-ms-transition:all 1s;-o-transition:all 1s;z-index:9}.Blog-module--landing--b9d64 .Blog-module--backToTop--f0b20 a{-webkit-tap-highlight-color:rgba(0,0,0,0)}.Blog-module--landing--b9d64 .Blog-module--backToTopLight--8af26{color:#aaa}@media(max-width:900px){.Blog-module--landing--b9d64{padding:5rem 0 4rem}.Blog-module--landing--b9d64 .Blog-module--preText--dd4ca{font-size:1.1rem}.Blog-module--landing--b9d64 .Blog-module--name--330c9{font-size:2.5rem;margin-bottom:.2rem}.Blog-module--landing--b9d64 .Blog-module--titlesection--7b699{border-bottom:2px #aaa;border-style:dashed;margin-bottom:1rem;margin-left:5%;max-width:700px;padding-bottom:2rem;text-align:left;width:90%}.Blog-module--landing--b9d64 .Blog-module--postslist--d318d{margin-top:0;max-width:1000px;width:90%}.Blog-module--landing--b9d64 .Blog-module--bloglist__item--5da32{padding-bottom:2rem;padding-top:2rem}.Blog-module--landing--b9d64 .Blog-module--bloglist__title--3941a{font-size:1.3rem;line-height:1.25}.Blog-module--landing--b9d64 .Blog-module--bloglist__author--454b0{font-size:.8rem;margin-bottom:4%}.Blog-module--landing--b9d64 .Blog-module--bloglist__content--103f6{font-size:.85rem;line-height:1.4;margin-top:4%}.Blog-module--landing--b9d64 .Blog-module--footer--5b35a{font-size:.75rem;margin-top:2rem}.Blog-module--landing--b9d64 .Blog-module--blogpost__content--da07b{max-width:700px;width:90%}.Blog-module--landing--b9d64 .Blog-module--blogpost__title--b267b{font-size:1.75rem;margin-bottom:2%}.Blog-module--landing--b9d64 .Blog-module--blogpost__subtitle--7beb8{font-size:1.1rem;line-height:1.35;margin-bottom:5%;margin-top:5%}.Blog-module--landing--b9d64 .Blog-module--blogpost__author--8b1e2{font-size:.85rem;margin-bottom:4%}.Blog-module--landing--b9d64 .Blog-module--blogpost__header--95f0b{margin-bottom:8%}.Blog-module--landing--b9d64 .Blog-module--backToTop--f0b20{bottom:4rem}}.Main-module--main__shell--8feef{background-color:#000;color:#fff;flex:1 1;height:100%;min-height:100vh;transition:background .25s,color .25s;width:100%}.Main-module--main__shell--8feef .Main-module--main__section--3606d{align-items:center;display:flex;flex-flow:column;justify-content:center;min-height:100vh;width:100%}@media(max-width:900px){.Main-module--main__shell--8feef .Main-module--main__section--3606d{max-width:100vw;width:100%}}.Main-module--main__shellLight--2911d{background-color:#eee;color:#555}._404-module--main404--5c6c7{align-items:center;display:flex;font-size:1.5rem;justify-content:center;padding-left:20px;padding-right:20px;width:100vw}.Landing-module--landing--0a60a{line-height:1.1;overflow-x:hidden;padding-left:150px;padding-right:150px}.Landing-module--landing--0a60a .Landing-module--preText--6be4c{font-size:1.5rem}.Landing-module--landing--0a60a .Landing-module--name--bf4eb{font-size:4rem;font-weight:900;margin-left:-5px}.Landing-module--landing--0a60a .Landing-module--postText--c79c8{font-size:2rem;font-weight:300}.Landing-module--landing--0a60a .Landing-module--longText--faa78{font-size:1.2rem;line-height:1.2;margin-top:1rem;max-width:40rem}@media(max-width:900px){.Landing-module--landing--0a60a{padding-bottom:2rem;padding-left:2rem;padding-right:2rem}.Landing-module--landing--0a60a .Landing-module--preText--6be4c{font-size:.9rem}.Landing-module--landing--0a60a .Landing-module--name--bf4eb{font-size:2.5rem;margin-left:-3px}.Landing-module--landing--0a60a .Landing-module--postText--c79c8{font-size:1.2rem;font-weight:700}.Landing-module--landing--0a60a .Landing-module--longText--faa78{font-size:.9rem;line-height:1.3;margin-top:.7rem}}.About-module--aboutLanding--c51cd{overflow:hidden;padding-left:1.5rem;padding-right:1.5rem}.About-module--aboutOuter--ffcff{display:flex;flex-direction:row;max-width:700px;overflow:hidden;padding:6rem 0;scroll-behavior:smooth}.About-module--aboutOuter--ffcff .About-module--aboutImage--1862c{animation:About-module--morphing--60ccd 6s infinite;animation-timing-function:linear;border-radius:50%;border-radius:50% 30% 30% 50%/50% 50% 30% 30%;margin:auto;max-width:90%;width:200px}.About-module--aboutOuter--ffcff .About-module--aboutImage--1862c:hover{animation-play-state:paused}.About-module--aboutOuter--ffcff .About-module--aboutImageOuter--327e8{align-items:center;display:flex;justify-content:center;padding-right:.7rem;text-align:right}.About-module--aboutOuter--ffcff .About-module--aboutMain--a5554{border-left:2px solid #777;padding-bottom:2rem;padding-left:1.5rem;padding-top:2rem}.About-module--aboutOuter--ffcff .About-module--aboutMainQuote--20e41{font-size:2rem;font-weight:700;margin-bottom:1rem}.About-module--aboutOuter--ffcff .About-module--smileEmoji--e57ed{font-size:2rem}.About-module--aboutOuter--ffcff .About-module--aboutMainContent--c774d{font-size:1.15rem;letter-spacing:.2px;line-height:1.5}.About-module--aboutOuter--ffcff .About-module--aboutMainContent--c774d strong{font-weight:700}.About-module--aboutOuter--ffcff .About-module--aboutMainContent--c774d a{text-decoration:underline;text-underline-offset:.2rem}@media(max-width:900px){.About-module--aboutOuter--ffcff{align-items:center;flex-direction:column;max-width:600px}.About-module--aboutOuter--ffcff .About-module--aboutImageOuter--327e8{padding-right:0;text-align:center}.About-module--aboutOuter--ffcff .About-module--aboutImage--1862c{border-radius:40%;margin:auto;max-width:80%}.About-module--aboutOuter--ffcff .About-module--aboutMain--a5554{border-left:none;margin-top:2rem;padding-bottom:0;padding-left:0;padding-top:0}.About-module--aboutOuter--ffcff .About-module--aboutMainQuote--20e41{font-size:1.3rem;line-height:1.3;text-align:center}.About-module--aboutOuter--ffcff .About-module--smileEmoji--e57ed{font-size:1.3rem}.About-module--aboutOuter--ffcff .About-module--aboutMainContent--c774d{font-size:1rem;line-height:1.5}}@keyframes About-module--morphing--60ccd{0%{border-radius:50% 30% 30% 50%/50% 50% 30% 30%}12%{border-radius:48% 38% 32% 48%/40% 48% 50% 42%}25%{border-radius:38% 42% 35% 46%/35% 46% 64% 54%}37%{border-radius:42% 46% 34% 42%/45% 40% 55% 49%}50%{border-radius:47% 59% 33% 37%/55% 37% 43% 45%}62%{border-radius:40% 48% 45% 42%/50% 40% 40% 40%}75%{border-radius:38% 42% 36% 52%/43% 45% 35% 35%}87%{border-radius:46% 34% 32% 53%/46% 47% 32% 33%}to{border-radius:50% 30% 30% 50%/50% 50% 30% 30%}}.Books-module--booksLanding--d8c82{padding-top:5rem}.Blogpost-module--paragraph--24cce{font-size:1.1rem;letter-spacing:.03rem;line-height:1.5;margin-bottom:2%}.Blogpost-module--paragraph--24cce a{text-decoration:underline}.Blogpost-module--paragraph--24cce strong{font-weight:700}.Blogpost-module--paragraph--24cce em,.Blogpost-module--paragraph--24cce i{font-style:italic}@media(max-width:900px){.Blogpost-module--paragraph--24cce{font-size:1rem;line-height:1.3;margin-bottom:4%}}.Blogpost-module--codeblock--b46bb{font-family:Source Code Pro,monospace!important;font-size:.9rem;line-height:1.4;margin-bottom:4%;margin-top:4%;overflow:scroll;padding:4%}@media(max-width:900px){.Blogpost-module--codeblock--b46bb{font-size:.8rem;margin-bottom:8%;margin-top:8%;overflow:scroll}}.Blogpost-module--code--7cd1e{word-wrap:break-word;background-color:#333;display:inline;font-family:Source Code Pro,monospace!important;font-size:.9rem;padding-left:.75%;padding-right:.75%}.Blogpost-module--code__light--70872{background-color:#ddd}.Blogpost-module--ul--7d1eb{font-size:1.1rem;line-height:1.5;list-style:disc;list-style-position:inside;margin-left:20px;text-indent:-20px}@media(max-width:900px){.Blogpost-module--ul--7d1eb{font-size:1rem;line-height:1.3;margin-bottom:4%}}.Blogpost-module--ol--b55e4{list-style:decimal;list-style-position:inside}.Blogpost-module--li--5e5a4{font-size:1.1rem;line-height:1.5;margin-bottom:1%}.Blogpost-module--li--5e5a4 a{text-decoration:underline}.Blogpost-module--li--5e5a4 strong{font-weight:700}.Blogpost-module--li--5e5a4 em,.Blogpost-module--li--5e5a4 i{font-style:italic}@media(max-width:900px){.Blogpost-module--li--5e5a4{font-size:1rem;line-height:1.3}}.Blogpost-module--h2--22ac5{font-size:1.3rem;font-weight:700;margin-bottom:5%;margin-top:5%}@media(max-width:900px){.Blogpost-module--h2--22ac5{margin-bottom:7%;margin-top:7%}}.Blogpost-module--image--3bb92{margin-bottom:4%;margin-top:4%}@media(max-width:900px){.Blogpost-module--image--3bb92{margin-bottom:10%;margin-top:10%}}.Blogpost-module--h3--f8050{font-size:1.2rem;font-weight:700;margin-bottom:4%;margin-top:4%}@media(max-width:900px){.Blogpost-module--h3--f8050{margin-bottom:6%;margin-top:6%}}.Blogpost-module--h4--929b9{font-size:1.1rem;font-weight:700;margin-bottom:3%;margin-top:3%}@media(max-width:900px){.Blogpost-module--h4--929b9{margin-bottom:5%;margin-top:5%}}</style><link rel="preconnect" href="https://www.googletagmanager.com"/><link rel="dns-prefetch" href="https://www.googletagmanager.com"/><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){const t=e.target;if(void 0===t.dataset.mainImage)return;if(void 0===t.dataset.gatsbyImageSsr)return;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><link rel="sitemap" type="application/xml" href="/sitemap-index.xml"/><link rel="icon" href="/favicon-32x32.png?v=b3dab8f0e24dcbb1d8eb43e4d104b5f3" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=b3dab8f0e24dcbb1d8eb43e4d104b5f3"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=b3dab8f0e24dcbb1d8eb43e4d104b5f3"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=b3dab8f0e24dcbb1d8eb43e4d104b5f3"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=b3dab8f0e24dcbb1d8eb43e4d104b5f3"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=b3dab8f0e24dcbb1d8eb43e4d104b5f3"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=b3dab8f0e24dcbb1d8eb43e4d104b5f3"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=b3dab8f0e24dcbb1d8eb43e4d104b5f3"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=b3dab8f0e24dcbb1d8eb43e4d104b5f3"/><title data-react-helmet="true">The what, why, and how of Message Queues | Dakshraj Sharma</title></head><body class="whiteBG"><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="index-module--page__shell--cc2b2 index-module--page__shellLight--60f33"><div style="visibility:hidden"><nav class="Navbar-module--navbar__shell--1f077 Navbar-module--navbar__shellLight--83233"><ul><li class="Aside-module--glowonhoverLight--091a2"><a href="/">Home</a></li><li class="Aside-module--glowonhoverLight--091a2"><a href="/blog">Blog</a></li><li class="Aside-module--glowonhoverLight--091a2"><a href="/reading">Reading</a></li><li class="Aside-module--glowonhoverLight--091a2"><a href="/about">About</a></li></ul></nav><aside class="Aside-module--aside__shell--3fbae Aside-module--aside__shellLight--c6f46"><div class="Aside-module--awiggleup--fc910 Aside-module--aside__element--f68e4 Aside-module--aside__email--edda5 Aside-module--glowonhoverLight--091a2"><a href="mailto:sharmarajdaksh@gmail.com" aria-label="Email"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M256 8C118.941 8 8 118.919 8 256c0 137.059 110.919 248 248 248 48.154 0 95.342-14.14 135.408-40.223 12.005-7.815 14.625-24.288 5.552-35.372l-10.177-12.433c-7.671-9.371-21.179-11.667-31.373-5.129C325.92 429.757 291.314 440 256 440c-101.458 0-184-82.542-184-184S154.542 72 256 72c100.139 0 184 57.619 184 160 0 38.786-21.093 79.742-58.17 83.693-17.349-.454-16.91-12.857-13.476-30.024l23.433-121.11C394.653 149.75 383.308 136 368.225 136h-44.981a13.518 13.518 0 0 0-13.432 11.993l-.01.092c-14.697-17.901-40.448-21.775-59.971-21.775-74.58 0-137.831 62.234-137.831 151.46 0 65.303 36.785 105.87 96 105.87 26.984 0 57.369-15.637 74.991-38.333 9.522 34.104 40.613 34.103 70.71 34.103C462.609 379.41 504 307.798 504 232 504 95.653 394.023 8 256 8zm-21.68 304.43c-22.249 0-36.07-15.623-36.07-40.771 0-44.993 30.779-72.729 58.63-72.729 22.292 0 35.601 15.241 35.601 40.77 0 45.061-33.875 72.73-58.161 72.73z"></path></svg></a></div><div class="Aside-module--awiggleup--fc910 Aside-module--aside__element--f68e4 Aside-module--glowonhoverLight--091a2"><a href="https://github.com/sharmarajdaksh" aria-label="Github URL" target="__blank"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 496 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></a></div><div class="Aside-module--awiggleup--fc910 Aside-module--aside__element--f68e4 Aside-module--glowonhoverLight--091a2"><a href="https://www.linkedin.com/in/sharmarajdaksh/" aria-label="LinkedIn URL" target="__blank"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg></a></div><div class="Aside-module--awiggleup--fc910 Aside-module--aside__element--f68e4 Aside-module--glowonhoverLight--091a2"><a href="https://stackoverflow.com/users/9134637/dakshraj-sharma" aria-label="StackOverflow URL" target="__blank"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 384 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M290.7 311L95 269.7 86.8 309l195.7 41zm51-87L188.2 95.7l-25.5 30.8 153.5 128.3zm-31.2 39.7L129.2 179l-16.7 36.5L293.7 300zM262 32l-32 24 119.3 160.3 32-24zm20.5 328h-200v39.7h200zm39.7 80H42.7V320h-40v160h359.5V320h-40z"></path></svg></a></div><div class="Aside-module--awiggleup--fc910 Aside-module--aside__element--f68e4 Aside-module--glowonhoverLight--091a2"><a href="https://medium.com/@sharmarajdaksh" aria-label="Medium URL" target="__blank"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M0 32v448h448V32H0zm372.2 106.1l-24 23c-2.1 1.6-3.1 4.2-2.7 6.7v169.3c-.4 2.6.6 5.2 2.7 6.7l23.5 23v5.1h-118V367l24.3-23.6c2.4-2.4 2.4-3.1 2.4-6.7V199.8l-67.6 171.6h-9.1L125 199.8v115c-.7 4.8 1 9.7 4.4 13.2l31.6 38.3v5.1H71.2v-5.1l31.6-38.3c3.4-3.5 4.9-8.4 4.1-13.2v-133c.4-3.7-1-7.3-3.8-9.8L75 138.1V133h87.3l67.4 148L289 133.1h83.2v5z"></path></svg></a></div><div class="Aside-module--awiggleup--fc910 Aside-module--aside__element--f68e4 Aside-module--glowonhoverLight--091a2"><button aria-label="Toggle Theme"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M283.211 512c78.962 0 151.079-35.925 198.857-94.792 7.068-8.708-.639-21.43-11.562-19.35-124.203 23.654-238.262-71.576-238.262-196.954 0-72.222 38.662-138.635 101.498-174.394 9.686-5.512 7.25-20.197-3.756-22.23A258.156 258.156 0 0 0 283.211 0c-141.309 0-256 114.511-256 256 0 141.309 114.511 256 256 256z"></path></svg></button></div><div class="Aside-module--aside__verticalline--53555"></div></aside><main class="Main-module--main__shell--8feef Main-module--main__shellLight--2911d Blog-module--landing--b9d64"><div class="Blog-module--titlesection--7b699"><a href="/"><h1 class="Blog-module--name--330c9" data-aos="fade-right" data-aos-duration="375">Dakshraj Sharma.</h1></a><h2 class="Blog-module--preText--dd4ca" data-aos="fade-right" data-aos-delay="375" data-aos-duration="375">ramblings of a serial technical experimenter.</h2><div class="Blog-module--backToTop--f0b20 Blog-module--backToTopLight--8af26" style="opacity:0"><a href="[object Object]"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M8 256C8 119 119 8 256 8s248 111 248 248-111 248-248 248S8 393 8 256zm292 116V256h70.9c10.7 0 16.1-13 8.5-20.5L264.5 121.2c-4.7-4.7-12.2-4.7-16.9 0l-115 114.3c-7.6 7.6-2.2 20.5 8.5 20.5H212v116c0 6.6 5.4 12 12 12h64c6.6 0 12-5.4 12-12z"></path></svg></a></div></div><section class="Blog-module--blogpost__content--da07b"><div class="Blog-module--blogpost__header--95f0b" data-aos="fade-up" data-aos-duration="200"><div class="Blog-module--blogpost__title--b267b">The what, why, and how of Message Queues</div><div class="Blog-module--blogpost__subtitle--7beb8">If you have ever heard of message queues like Apache Kafka and been confused about the what, why and how of messaging queues in modern applications, this one is for you.</div><div class="Blog-module--blogpost__author--8b1e2">June 06, 2020<!-- --> | <!-- -->Dakshraj Sharma<!-- --> |<!-- --> <!-- -->18 minute read</div><div class="Blog-module--divider--4f8db"></div></div><div data-aos="fade-up" data-aos-duration="1000"><p class="Blogpost-module--paragraph--24cce">If you have had any amount of interest in things like scalable architectures and microservices, there is a good chance you have come across messaging queues. Perhaps you have heard of companies making use of Apache Kafka, or an alternative like RabbitMQ, those two being the most popular messaging queues in use today. And, perhaps, just like me, you were confused by what messaging queues did and how they helped modern distributed architectures. Let&#x27;s try to understand that.</p>
<p class="Blogpost-module--paragraph--24cce">First things first, let&#x27;s get the absolute basics out of the way. What even is a messaging queue?</p>
<h2 class="Blogpost-module--h2--22ac5">What is a messaging queue?</h2>
<p class="Blogpost-module--paragraph--24cce">Messaging queues or brokers are components used for inter-process communication or for inter-microservice communication, whereby messages between multiple services are passed not through direct transfer of data, but through a common &quot;queue&quot; or buffer in the form of these messaging queues. The paradigm is similar to the publisher/subscriber model, whereby multiple publishers or &quot;producers&quot; push messages into &quot;queues&quot;, and subscribers or &quot;consumers&quot; can listen for new messages coming into the queue. As the consumer &quot;consumes&quot; or picks up a message from the queue, the message is removed from the queue. The model is asynchronous in nature, such that the interaction of producers and consumers with the queue is completely independent of one another.</p>
<span><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 626px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/ade338538a4782eb9ebe2212fc107924/af590/MQ1.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 44.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA8UlEQVR42nWShw6EMAxD+f/vZIm9N+T0IvnEIS6SlTZNXNcQXNdl53kaGSiO4/C6zrRWXaE51QIWZVlaXdfW972jbVsrisKapvGzPM99n2WZdV1n8zw7MWCuqirvZe+EcRxbkiR+QE7T1AmmabJxHL2ZSyBf19XrkAJ6oyjyS7+E27aZMsGaZqklo4zMBeojWEMkjsAeIU/2fX+FBv9FAPswDK6Ip0ghSlAlf/AK0MuzFezpBf5k1OBBGIY+KG/wZFkWH4aYQQhRyLD8xX9mfzzkABIIngohwUcuA9TvCiGCkI/z6qHin4fg/r+yR4w+1AcV77yWFKgQMQAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Message Queue"
        title=""
        src="/static/ade338538a4782eb9ebe2212fc107924/af590/MQ1.png"
        srcset="/static/ade338538a4782eb9ebe2212fc107924/772e8/MQ1.png 200w,
/static/ade338538a4782eb9ebe2212fc107924/e17e5/MQ1.png 400w,
/static/ade338538a4782eb9ebe2212fc107924/af590/MQ1.png 626w"
        sizes="(max-width: 626px) 100vw, 626px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></span>
<p class="Blogpost-module--paragraph--24cce">Maybe you&#x27;re still confused. Let&#x27;s try to understand a use cases for such messaging queues to aid your understanding.</p>
<h2 class="Blogpost-module--h2--22ac5">What are some use cases for messaging queues?</h2>
<p class="Blogpost-module--paragraph--24cce">As you might have correctly guessed, messaging queues aren&#x27;t meant for real-time communication. To take a made up, unrealistic scenario, using them as an intermediate, say, for an HTTP request where the user has to wait on the response is probably not a good idea. Using messaging queues in a producer-consumer model gives us no guarantee of when the consumer actually will take up the message for processing. All we have is a guarantee that the message will <em>eventually</em> get consumed and processed. <em>That&#x27;s not exactly true, because in real-world large-scale systems, things like queue overflows may be a real problem. But for our understanding, we will be assuming a relatively fail-safe system</em>. Owing to these asynchronous nature, messaging queues are good for processes that are not crucial but nice to have done. The processes which are performed by the consumers should, ideally, not be core to the functioning of the overall architecture and functionality of the application, but they may be processes which help improve the functionality and/or performance of the application.</p>
<p class="Blogpost-module--paragraph--24cce">Some of the use cases for messaging queues in real-world scenarios today are listed below:</p>
<h4 class="Blogpost-module--h4--929b9">Sending emails</h4>
<p class="Blogpost-module--paragraph--24cce">Emails are used for a large number of purposes, such marketing campaigns, account verification, password resets, et cetera. If you think about these use cases, you may realize that none of them need immediate processing. Delays in the dispatch of these emails is completely acceptable and does not detract from the core functionality of the applications utilizing emails for various purposes. Message queues can help in such a case.</p>
<span><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 651px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/8ce68cbc116a7969c676d88e8c41b33e/1ac66/email.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 46%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA7ElEQVR42qWSaQqDQAyFvf+hPIM/FUEQUXFX3NeUL0WxhUJLA2Fm8jIvL5kx5E+bpknatpWu62TbNjGO45B93y//1riHlWUppmmKZVlPwmVZJAxDsW1bxnF8Sf7G5nkWz/MkCAI9GwSSJNFg0zSaQBHUUnFdV030fV/iONY9ONi9bVwJ2aRpqskQQjAMg6qNokjyPFeM/enMDJzcuq4lyzLl0JYJ0rLjOErEGZVcQDkXiqKQqqp0xU8cpZwpehECoABSBkwSqgEp0Pe9vuDdiZ2jIO8cD7PXll3X1VdCxa+P8m7G/cv88m0+ET4AIJu9L1Mhx4oAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Email"
        title=""
        src="/static/8ce68cbc116a7969c676d88e8c41b33e/1ac66/email.png"
        srcset="/static/8ce68cbc116a7969c676d88e8c41b33e/772e8/email.png 200w,
/static/8ce68cbc116a7969c676d88e8c41b33e/e17e5/email.png 400w,
/static/8ce68cbc116a7969c676d88e8c41b33e/1ac66/email.png 651w"
        sizes="(max-width: 651px) 100vw, 651px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></span>
<ul class="Blogpost-module--ul--7d1eb">
<li class="Blogpost-module--li--5e5a4">Multiple &quot;producer&quot; service which generate emails and require them to be published can push email objects (by objects I mean some formatted objects that contain all nececssary data such as the content, receiver, subject, etc. for the email) into the queue.</li>
<li class="Blogpost-module--li--5e5a4">A single consumer microservice, dedicated to sending emails, works completely independently of where the email comes from. This service consumes messages from the queue one by one and sends emails as specified in the email object.</li>
<li class="Blogpost-module--li--5e5a4">This approach is well scalable, as in case the number of incoming messages to queue gets too large, we may horizontally scale (read: add more number of) consumer email service instances that may all listen to the same queue, sending emails.</li>
</ul>
<h4 class="Blogpost-module--h4--929b9">Data post-processing</h4>
<p class="Blogpost-module--paragraph--24cce">Assume you have a Blogging application which needs to handle large amounts of image data, from images uploaded by users themselves. Users can&#x27;t be expected to provide images which are web-optimized or small in size. However, declining users from uploading certain images due to size may not be the best user experience, and you may want to allow users to upload any images they want if your architecture and storagre capacity is capable of handling it.</p>
<p class="Blogpost-module--paragraph--24cce">One solution for allowing user&#x27;s flexibility while not impacting the load times of your application negatively (owing to larger assets) is to post-process and optimize all images that are uploaded by the user. This is not at all a crucial operation: while it may impact user experience slightly, the optimization is in no way crucial to the application functionality, nor is it necessary that the action be performed instantly. A service may be employed in the application architecture whose sole purpose is optimizing images that get uploaded on the application. A message queue can help in this scenario. The flow of control and messages for the same may be something like this:</p>
<ul class="Blogpost-module--ul--7d1eb">
<li class="Blogpost-module--li--5e5a4">User publishes a blog post with some high-quality, large images.</li>
<li class="Blogpost-module--li--5e5a4">Image gets pushed to storage (something like AWS S3 or Azure Blob Storage).</li>
<li class="Blogpost-module--li--5e5a4">A hook is triggered in the application, pushing a message with information on the newly uploaded image into the &quot;image optimization&quot; queue.</li>
<li class="Blogpost-module--li--5e5a4">The image optimization service can listen on the queue. It pulls an image from S3, optimizes it, and them reuploads the optimized image to replace the unoptimized one on S3.</li>
</ul>
<h4 class="Blogpost-module--h4--929b9">Batch updates for databases</h4>
<p class="Blogpost-module--paragraph--24cce">Databases are used for many purposes. Not all of them are crucial to application usability. Assume you have an application like Spotify. This application may have databases storing user data, which the user can update and/or view at any time. This data is important and any changes in this data may need to be reflected immediately. On the other hand, your application may have a statistical/machine learning engine, which analyzes user actions for any reason, be it for optimizing recommendations or for generating stats. This operation may be considered non-crucial in terms of how immediate the updates need to be. In general, delays in the integration of latest user activity into the machine learning algorithms may we completely acceptable. Here, a message queue may be used for optimizing database querying.</p>
<p class="Blogpost-module--paragraph--24cce">Establishment of a database connection has some overhead irrespective of the amount of data that is transferred. Even if a persistent connection be used, transit times become a factor for large-scale systems. In general, if possible, batching is suggested for operations such as record insertion. In the scenario represented above, each action by the user such as song listen, like, playlist creation, etc. may be used for optimizing user recommendations. However, creating a database request for every single such operation would be insanity, for lack of a better word.</p>
<p class="Blogpost-module--paragraph--24cce">Instead a better approach may be this:</p>
<ul class="Blogpost-module--ul--7d1eb">
<li class="Blogpost-module--li--5e5a4">For every action, push the action data to a message queue. This will be magnitudes faster than sending the data directly to the database.</li>
<li class="Blogpost-module--li--5e5a4">A consumer service may cache these activities&#x27; data on a per-user basis as they come into the queue.<!-- -->
<ul class="Blogpost-module--ul--7d1eb">
<li class="Blogpost-module--li--5e5a4">Caching here is acceptable for two reasons. One, this data is non-critical. Losing this data will not break the application, and the user will neveer be affected or even know. Two, using a cache is much faster for temporary data (Of course cost is also a factor, but let&#x27;s not dive into that for the purpose of this article).</li>
</ul>
</li>
<li class="Blogpost-module--li--5e5a4">On a regular interval, the consuming service may use the cached data, transform it into a single database insertion query, and commit that change to the database.</li>
</ul>
<p class="Blogpost-module--paragraph--24cce">How the machine learning/data warehousing engine later uses the data is a completely different story, but I hope are able to get a grasp on the several use cases for message queues. Now that you have an idea of the basic concept, let&#x27;s look into some of the main features of messaging queues.</p>
<h2 class="Blogpost-module--h2--22ac5">Features / Advantages of message queues</h2>
<ul class="Blogpost-module--ul--7d1eb">
<li class="Blogpost-module--li--5e5a4"><strong>Decoupling</strong>: Operations of the consumer and producer are completely independent of one another.</li>
<li class="Blogpost-module--li--5e5a4"><strong>Scalability</strong>: The number of producers and consumers can easily be scaled as required.</li>
<li class="Blogpost-module--li--5e5a4"><strong>Buffering and load management</strong>: Message queues act essentially as data buffers. In case of a spike in the amount of data that needs to be processed by the consumer service, the latter needs not be made aware of the fact. The message queue buffers the data for the service, and the service only needs to process the data one by one, rather than having to manage a large amount of data all at once. This makes your architecture more robust overall.</li>
<li class="Blogpost-module--li--5e5a4"><strong>Resiliency</strong>: Even if your consumer processes go down, it doesn&#x27;t mean that your application breaks. Messages for the consumer will remain queued in the messaging queue. Whenever the consumer service comes back up, it can start processing the messages without having to do any additional setup or work.</li>
<li class="Blogpost-module--li--5e5a4"><strong>Delivery guarantees</strong>: Message queues offer a general guarantee that any message that gets pushed to a queue will get delivered to a consumer <em>eventually</em>.</li>
<li class="Blogpost-module--li--5e5a4"><strong>Order guarantee</strong>: Being a queue, an order is associated to the incoming messages implicitly. The same order is followed in the consumption and processing of the data.</li>
</ul>
<p class="Blogpost-module--paragraph--24cce">Now, hopefully you have a slightly better understanding of the what and why of messaging queues, compared to when you started reading this article. Now, let&#x27;s try using a messaging queue in a small application to understand how it would be used in an actual application.</p>
<h2 class="Blogpost-module--h2--22ac5">Using a messaging queue in code</h2>
<p class="Blogpost-module--paragraph--24cce"><strong>Disclaimer</strong>: The application that I&#x27;ll be using is a very simple one, and it honestly does nothing of value. However, it should allow you to understand where a messaging queue may fit into a real application.</p>
<p class="Blogpost-module--paragraph--24cce">The architecture for the application will be something like this:</p>
<span><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 591px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/f9b6f0fad2b4874cd7bc703a4f975247/e4c9a/app.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 34%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAx0lEQVR42qWRWQqEMAyGe//LeQAFxYIibrjvZvgCkRmYNwMhaUr+pXXXdQlBve9b3oZr21bqupaqqmTf9wf8PM+fPI7jqSbiLyBgSZJIURQyTZNs2yZlWcowDNovy6JJv67rcyYAZ4fKDCI3jqMq6/teL7ANGLN5niWOY0nTVMIwVFKCHQBw573X+6Zp1IHL81yCIJAoihQAJdhnwZhRZncQmUL6rutUDCSqEHuAZVmmDPaGgJCAWNrs+w3tI606QDiY3be//AGAsyKj91+53gAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="App"
        title=""
        src="/static/f9b6f0fad2b4874cd7bc703a4f975247/e4c9a/app.png"
        srcset="/static/f9b6f0fad2b4874cd7bc703a4f975247/772e8/app.png 200w,
/static/f9b6f0fad2b4874cd7bc703a4f975247/e17e5/app.png 400w,
/static/f9b6f0fad2b4874cd7bc703a4f975247/e4c9a/app.png 591w"
        sizes="(max-width: 591px) 100vw, 591px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></span>
<p class="Blogpost-module--paragraph--24cce">For the messaging queues, I&#x27;ll be using <a href="https://www.rabbitmq.com/">RabbitMQ</a>, it being one of the easier to use messaging queue systems. The concepts should be transferrable to any other system such as Apache Kafka, which work on the same principles. For the application components, I use docker, and then docker-compose for putting up the containers. For the application code, I use NodeJS in the example. However, of course, the concept will be language agnostic.</p>
<h3 class="Blogpost-module--h3--f8050">Setup</h3>
<p class="Blogpost-module--paragraph--24cce">Let&#x27;s see the directory structure used for the application. All the code for the repository will be available <a href="https://github.com/sharmarajdaksh/using-messaging-queues">here</a>.</p>
<pre class="prism-code language- Blogpost-module--codeblock--b46bb" style="color:rgb(36, 41, 46);background-color:#FAFAFA"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">|-consumer/</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">|    |-Dockerfile</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">|    |-package.json</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">|    |-app.js</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">|-producer/</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">|    |-Dockerfile</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">|    |-package.json</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">|    |-app.js</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">|-secondary_producer/</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">|    |-Dockerfile</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">|    |-package.json</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">|    |-app.js</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">|-docker-compose.yml</span></div></pre>
<p class="Blogpost-module--paragraph--24cce">The package.json file in NodeJS applications is used for managing dependencies and application metadata. The dependencies for the three applications are identical, and the package.json files for each of the three applications is almost identical. You may change the &quot;name&quot; key to match the application, but even that&#x27;s not mandatory.</p>
<pre class="prism-code language-json Blogpost-module--codeblock--b46bb" style="color:rgb(36, 41, 46);background-color:#FAFAFA"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token property" style="color:rgb(3, 47, 98)">&quot;name&quot;</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(3, 47, 98)">&quot;producer&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token property" style="color:rgb(3, 47, 98)">&quot;version&quot;</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(3, 47, 98)">&quot;1.0.0&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token property" style="color:rgb(3, 47, 98)">&quot;description&quot;</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(3, 47, 98)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token property" style="color:rgb(3, 47, 98)">&quot;main&quot;</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(3, 47, 98)">&quot;app.js&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token property" style="color:rgb(3, 47, 98)">&quot;scripts&quot;</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token property" style="color:rgb(3, 47, 98)">&quot;start&quot;</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(3, 47, 98)">&quot;node app.js&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token property" style="color:rgb(3, 47, 98)">&quot;author&quot;</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(3, 47, 98)">&quot;Dakshraj Sharma&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token property" style="color:rgb(3, 47, 98)">&quot;license&quot;</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(3, 47, 98)">&quot;ISC&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token property" style="color:rgb(3, 47, 98)">&quot;dependencies&quot;</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token property" style="color:rgb(3, 47, 98)">&quot;amqplib&quot;</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(3, 47, 98)">&quot;^0.5.6&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span></div></pre>
<p class="Blogpost-module--paragraph--24cce">Now, for the Dockerfiles. The Dockerfiles for each of the three applications is exactly the same since they are each nothing but simple NodeJS applications.</p>
<pre class="prism-code language-dockerfile Blogpost-module--codeblock--b46bb" style="color:rgb(36, 41, 46);background-color:#FAFAFA"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">FROM node:alpine</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">WORKDIR /usr/app/</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">COPY ./package*.json ./</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">RUN npm install</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">RUN npm install -g pm2</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">COPY ./ ./</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">CMD [ &quot;pm2-runtime&quot;, &quot;npm&quot;, &quot;--&quot;, &quot;start&quot; ]</span></div></pre>
<p class="Blogpost-module--paragraph--24cce">This dockerfie does the following things:</p>
<ul class="Blogpost-module--ul--7d1eb">
<li class="Blogpost-module--li--5e5a4">Pulls the node:alpine image</li>
<li class="Blogpost-module--li--5e5a4">Creates a directory /usr/app for the application</li>
<li class="Blogpost-module--li--5e5a4">Copies to local package.json file to the continer&#x27;s /usr/app directory and then installs dependencies by running &#x27;npm install&#x27;.</li>
<li class="Blogpost-module--li--5e5a4">Installs pm2 using &#x27;npm install -g pm2&#x27; to ensure that the application restarts if it errors.</li>
<li class="Blogpost-module--li--5e5a4">Copies code file (essentially only app.js) to /usr/app.</li>
<li class="Blogpost-module--li--5e5a4">Runs the application using &#x27;pm2-runtime npm -- start&#x27;.
If you want to learn more about pm2, the <a href="https://pm2.keymetrics.io/">official website</a> may be a good place to start, but that may be beyond the scope of this article.</li>
</ul>
<p class="Blogpost-module--paragraph--24cce">Docker compose is responsible for running the four containers of our application together and allow connectivity between them. The content of the docker-compose.yml file is very simple:</p>
<pre class="prism-code language-yaml Blogpost-module--codeblock--b46bb" style="color:rgb(36, 41, 46);background-color:#FAFAFA"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token key atrule">version</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> </span><span class="token string">&quot;3&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token key atrule">services</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token key atrule">rabbitmq</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token key atrule">image</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> rabbitmq</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token number">3.8</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token key atrule">environment</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token key atrule">RABBITMQ_DEFAULT_USER</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> rabbitmq</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token key atrule">RABBITMQ_DEFAULT_PASS</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> rabbitmq</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token key atrule">producer</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token key atrule">build</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token key atrule">context</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> ./producer/</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token key atrule">dockerfile</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> Dockerfile</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token key atrule">restart</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> always</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token key atrule">depends_on</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(36, 41, 46)">-</span><span class="token plain"> rabbitmq</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token key atrule">environment</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token key atrule">RABBITMQ_HOST</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> rabbitmq</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token key atrule">RABBITMQ_USER</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> rabbitmq</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token key atrule">RABBITMQ_PASS</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> rabbitmq</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token key atrule">RABBITMQ_QUEUE</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> messages</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token key atrule">volumes</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(36, 41, 46)">-</span><span class="token plain"> /usr/app/node_modules</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(36, 41, 46)">-</span><span class="token plain"> ./producer</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain">/usr/app/</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token key atrule">consumer</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token key atrule">build</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token key atrule">context</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> ./consumer/</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token key atrule">dockerfile</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> Dockerfile</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token key atrule">restart</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> always</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token key atrule">depends_on</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(36, 41, 46)">-</span><span class="token plain"> rabbitmq</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token key atrule">environment</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token key atrule">RABBITMQ_HOST</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> rabbitmq</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token key atrule">RABBITMQ_USER</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> rabbitmq</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token key atrule">RABBITMQ_PASS</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> rabbitmq</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token key atrule">RABBITMQ_QUEUE</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> messages</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token key atrule">volumes</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(36, 41, 46)">-</span><span class="token plain"> /usr/app/node_modules</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(36, 41, 46)">-</span><span class="token plain"> ./consumer/</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain">/usr/app/</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token key atrule">secondary_producer</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token key atrule">build</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token key atrule">context</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> ./secondary_producer/</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token key atrule">dockerfile</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> Dockerfile</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token key atrule">restart</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> always</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token key atrule">depends_on</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(36, 41, 46)">-</span><span class="token plain"> rabbitmq</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token key atrule">environment</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token key atrule">RABBITMQ_HOST</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> rabbitmq</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token key atrule">RABBITMQ_USER</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> rabbitmq</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token key atrule">RABBITMQ_PASS</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> rabbitmq</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token key atrule">RABBITMQ_QUEUE</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> messages</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token key atrule">volumes</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(36, 41, 46)">-</span><span class="token plain"> /usr/app/node_modules</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(36, 41, 46)">-</span><span class="token plain"> ./secondary_producer</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain">/usr/app/</span></div></pre>
<p class="Blogpost-module--paragraph--24cce">We simply create four &#x27;services&#x27; or containers.</p>
<ul class="Blogpost-module--ul--7d1eb">
<li class="Blogpost-module--li--5e5a4">A rabbitmq container from the latest rabbitmq image.<!-- -->
<ul class="Blogpost-module--ul--7d1eb">
<li class="Blogpost-module--li--5e5a4">Password and username for connecting to rabbitmq are passed as environment variables.</li>
</ul>
</li>
</ul>
<pre class="prism-code language-yaml Blogpost-module--codeblock--b46bb" style="color:rgb(36, 41, 46);background-color:#FAFAFA"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token key atrule">RABBITMQ_DEFAULT_USER</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> rabbitmq</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token key atrule">RABBITMQ_DEFAULT_PASS</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> rabbitmq</span></div></pre>
<ul class="Blogpost-module--ul--7d1eb">
<li class="Blogpost-module--li--5e5a4">The service specification for remaining three services is exactly the same, barring the directory paths and service names.<!-- -->
<ul class="Blogpost-module--ul--7d1eb">
<li class="Blogpost-module--li--5e5a4">Build from the Dockerfile in the specified path:</li>
<li class="Blogpost-module--li--5e5a4">Tell docker-compose to restart the container if it goes down, and that the container should depend on the rabbitmq container.</li>
<li class="Blogpost-module--li--5e5a4">Set environment variables for the rabbitmq connection (will be used in the code) via &#x27;process.env&#x27;.</li>
</ul>
</li>
</ul>
<pre class="prism-code language-yaml Blogpost-module--codeblock--b46bb" style="color:rgb(36, 41, 46);background-color:#FAFAFA"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token key atrule">RABBITMQ_HOST</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> rabbitmq</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token key atrule">RABBITMQ_USER</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> rabbitmq</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token key atrule">RABBITMQ_PASS</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> rabbitmq</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token key atrule">RABBITMQ_QUEUE</span><span class="token punctuation" style="color:rgb(36, 41, 46)">:</span><span class="token plain"> messages</span></div></pre>
<p class="Blogpost-module--paragraph--24cce">Note the RABBITMQ_HOST variable. In a real-world scenario, this would be replaced by the IP/URL of the machine that is running RabbitMQ. If a local installation is being used, localhost may be specified. Since we are using docker-compose, specifying rabbitmq as an address will automatically be directed to the container/service named rabbitmq.</p>
<ul class="Blogpost-module--ul--7d1eb">
<li class="Blogpost-module--li--5e5a4">Bookmark /app/node_modules so we do not copy it repeatedly. Also, mount the local files to /usr/app so code changes may be reflected in real time if using nodemon.</li>
</ul>
<h3 class="Blogpost-module--h3--f8050">The code</h3>
<p class="Blogpost-module--paragraph--24cce">Let&#x27;s write up our first producer, inside &#x27;producer/app.js&#x27;. To connect with RabbitMQ, we will use the NPM library &#x27;amqplib&#x27;, which will be available for us to use since it was added as a dependency to our package.json already (see above).</p>
<pre class="prism-code language-javascript Blogpost-module--codeblock--b46bb" style="color:rgb(36, 41, 46);background-color:#FAFAFA"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> amqp </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">require</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token string">&quot;amqplib&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span></div></pre>
<p class="Blogpost-module--paragraph--24cce">We then store the environment variables as local <span class="Blogpost-module--code--7cd1e Blogpost-module--code__light--70872">const</span> values. Using the host, username, and password variables, we also form the connection string using Javascript template strings and store it as <span class="Blogpost-module--code--7cd1e Blogpost-module--code__light--70872">RABBITMQ_CONNECTION_STRING</span>.</p>
<pre class="prism-code language-javascript Blogpost-module--codeblock--b46bb" style="color:rgb(36, 41, 46);background-color:#FAFAFA"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token comment" style="color:rgb(106, 153, 85)">// Host address</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">RABBITMQ_HOST</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> process</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">env</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token constant" style="color:rgb(100, 102, 149)">RABBITMQ_HOST</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// Username</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">RABBITMQ_USER</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> process</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">env</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token constant" style="color:rgb(100, 102, 149)">RABBITMQ_USER</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// Password</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">RABBITMQ_PASS</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> process</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">env</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token constant" style="color:rgb(100, 102, 149)">RABBITMQ_PASS</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// Connection string: ampq://username:password@host</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">RABBITMQ_CONNECTION_STRING</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">amqp://</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(36, 41, 46)">${</span><span class="token template-string interpolation constant" style="color:rgb(100, 102, 149)">RABBITMQ_USER</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token template-string string">:</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(36, 41, 46)">${</span><span class="token template-string interpolation constant" style="color:rgb(100, 102, 149)">RABBITMQ_PASS</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token template-string string">@</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(36, 41, 46)">${</span><span class="token template-string interpolation constant" style="color:rgb(100, 102, 149)">RABBITMQ_HOST</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token template-string string">/</span><span class="token template-string template-punctuation string">`</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// The name of the queue we will connect to</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">RABBITMQ_QUEUE</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> process</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">env</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token constant" style="color:rgb(100, 102, 149)">RABBITMQ_QUEUE</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span></div></pre>
<p class="Blogpost-module--paragraph--24cce">You might be confused as to why we need to have a queue name value when we already have the host defined. This is because a single RabbitMQ can have many queues, independent of each other. Each of these queues is identified by a string identifier, which we have declared as an environment variable for the current application.</p>
<p class="Blogpost-module--paragraph--24cce">We define a function that returns a random number. In a real world scenario, this may have been any function that supplied some data which had to be passed into the messaging queue.</p>
<pre class="prism-code language-javascript Blogpost-module--codeblock--b46bb" style="color:rgb(36, 41, 46);background-color:#FAFAFA"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(111, 66, 193)">getRandomNumber</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(0, 92, 197)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#e3116c">return</span><span class="token plain"> </span><span class="token known-class-name class-name" style="color:rgb(227, 98, 9)">Math</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">random</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span></div></pre>
<p class="Blogpost-module--paragraph--24cce">Fairly basic stuff upto here. Now, let&#x27;s try to connect to the RabbitMQ instance, set up a queue if one doesn&#x27;t already exist, and then push in data to the queue. Connection and channel creation are asynchronous and return promises, so we then and catch blocks.</p>
<pre class="prism-code language-javascript Blogpost-module--codeblock--b46bb" style="color:rgb(36, 41, 46);background-color:#FAFAFA"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">amqp</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">connect</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token constant" style="color:rgb(100, 102, 149)">RABBITMQ_CONNECTION_STRING</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">then</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token parameter">conn</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(0, 92, 197)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token console class-name" style="color:rgb(227, 98, 9)">console</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">log</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token string">&quot;[ Connection Established ] &quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">toUpperCase</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)">//</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)">// Channel creation is idempotent:</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)">// A new channel is created only if one doesn&#x27;t already exist</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)">//</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#e3116c">return</span><span class="token plain"> conn</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">createChannel</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// Create a channel or connection</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">then</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token parameter">chan</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(0, 92, 197)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)">//</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)">// To send, we must declare a queue for us to send to</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)">// Here we use a queue named by the value of our RABBITMQ_QUEUE const</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)">//</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#e3116c">return</span><span class="token plain"> chan</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">assertQueue</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token constant" style="color:rgb(100, 102, 149)">RABBITMQ_QUEUE</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        </span><span class="token literal-property property">durable</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(0, 92, 197)">false</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// specify queue to send to</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">then</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(0, 92, 197)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        </span><span class="token comment" style="color:rgb(106, 153, 85)">//</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        </span><span class="token comment" style="color:rgb(106, 153, 85)">// We can then publish a message to the queue</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        </span><span class="token comment" style="color:rgb(106, 153, 85)">// Data is sent as byte streams so any content works</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        </span><span class="token comment" style="color:rgb(106, 153, 85)">//</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        </span><span class="token comment" style="color:rgb(106, 153, 85)">// The logic here is very simple:</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        </span><span class="token comment" style="color:rgb(106, 153, 85)">// we send a random number into the queue every second</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        </span><span class="token comment" style="color:rgb(106, 153, 85)">// A total of 50 times</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        </span><span class="token comment" style="color:rgb(106, 153, 85)">//</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        </span><span class="token keyword" style="color:#e3116c">let</span><span class="token plain"> n </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        </span><span class="token keyword" style="color:#e3116c">let</span><span class="token plain"> interval </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">setInterval</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(0, 92, 197)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">          n</span><span class="token operator" style="color:rgb(0, 92, 197)">++</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">          </span><span class="token keyword" style="color:#e3116c">let</span><span class="token plain"> randomNumber </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">getRandomNumber</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">          chan</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">sendToQueue</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            </span><span class="token constant" style="color:rgb(100, 102, 149)">RABBITMQ_QUEUE</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            </span><span class="token maybe-class-name">Buffer</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token keyword module" style="color:#e3116c">from</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">randomNumber</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">toString</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// Send data into queue</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">          </span><span class="token comment" style="color:rgb(106, 153, 85)">// Log the random number to console</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">          </span><span class="token console class-name" style="color:rgb(227, 98, 9)">console</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">log</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">[ Sent:     </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(36, 41, 46)">${</span><span class="token template-string interpolation">randomNumber</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token template-string string"> ] </span><span class="token template-string template-punctuation string">`</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">toUpperCase</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">          </span><span class="token keyword control-flow" style="color:#e3116c">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">n </span><span class="token operator" style="color:rgb(0, 92, 197)">===</span><span class="token plain"> </span><span class="token number">50</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            </span><span class="token comment" style="color:rgb(106, 153, 85)">// After 50 sends, stop sending</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            </span><span class="token function" style="color:rgb(111, 66, 193)">clearInterval</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">interval</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> </span><span class="token number">1000</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token keyword control-flow" style="color:#e3116c">catch</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token parameter">err</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(0, 92, 197)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)">// Catch any errors and log to console</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token console class-name" style="color:rgb(227, 98, 9)">console</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">log</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">err</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span></div></pre>
<p class="Blogpost-module--paragraph--24cce">To summarize what the code is doing:</p>
<ul class="Blogpost-module--ul--7d1eb">
<li class="Blogpost-module--li--5e5a4">Create a new connection to the RabbitMQ instance through</li>
</ul>
<pre class="prism-code language-javascript Blogpost-module--codeblock--b46bb" style="color:rgb(36, 41, 46);background-color:#FAFAFA"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">amqp</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">connect</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token constant" style="color:rgb(100, 102, 149)">RABBITMQ_CONNECTION_STRING</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">then</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token parameter">conn</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(0, 92, 197)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#e3116c">return</span><span class="token plain"> conn</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">createChannel</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// Create a channel or connection</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span></div></pre>
<ul class="Blogpost-module--ul--7d1eb">
<li class="Blogpost-module--li--5e5a4">Create a queue in the channel to send to</li>
</ul>
<pre class="prism-code language-javascript Blogpost-module--codeblock--b46bb" style="color:rgb(36, 41, 46);background-color:#FAFAFA"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">then</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token parameter">chan</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(0, 92, 197)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    	</span><span class="token keyword control-flow" style="color:#e3116c">return</span><span class="token plain"> chan</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    		</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">assertQueue</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token constant" style="color:rgb(100, 102, 149)">RABBITMQ_QUEUE</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    			</span><span class="token literal-property property">durable</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(0, 92, 197)">false</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    		</span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// specify queue to send to</span></div></pre>
<ul class="Blogpost-module--ul--7d1eb">
<li class="Blogpost-module--li--5e5a4">Send data into the queue</li>
</ul>
<pre class="prism-code language-javascript Blogpost-module--codeblock--b46bb" style="color:rgb(36, 41, 46);background-color:#FAFAFA"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">then</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(0, 92, 197)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        chan</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">sendToQueue</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        	</span><span class="token constant" style="color:rgb(100, 102, 149)">RABBITMQ_QUEUE</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        	</span><span class="token maybe-class-name">Buffer</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token keyword module" style="color:#e3116c">from</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token string">&quot;ANY MESSAGE HERE&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span></div></pre>
<p class="Blogpost-module--paragraph--24cce">For messages to be sent into the queue, any buffered bytes work. So, essentially, you could send a JSON.stringified object into the queue, which could be later parsed at the consumer end as a JSON object.</p>
<p class="Blogpost-module--paragraph--24cce">Now we have a producer up. Let&#x27;s create the secondary producer in &#x27;secondary_producer/app.js&#x27; with nearly identical code, which will send a random number into the queue 50 times, every 1.5 second. No explanation should be needed for the code as it is exactly the same as the code for the first producer. Note that we ensure here that the second producer also will send messages to the same queue.</p>
<pre class="prism-code language-javascript Blogpost-module--codeblock--b46bb" style="color:rgb(36, 41, 46);background-color:#FAFAFA"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> amqp </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">require</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token string">&quot;amqplib&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">RABBITMQ_HOST</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> process</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">env</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token constant" style="color:rgb(100, 102, 149)">RABBITMQ_HOST</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">RABBITMQ_USER</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> process</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">env</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token constant" style="color:rgb(100, 102, 149)">RABBITMQ_USER</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">RABBITMQ_PASS</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> process</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">env</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token constant" style="color:rgb(100, 102, 149)">RABBITMQ_PASS</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">RABBITMQ_CONNECTION_STRING</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">amqp://</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(36, 41, 46)">${</span><span class="token template-string interpolation constant" style="color:rgb(100, 102, 149)">RABBITMQ_USER</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token template-string string">:</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(36, 41, 46)">${</span><span class="token template-string interpolation constant" style="color:rgb(100, 102, 149)">RABBITMQ_PASS</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token template-string string">@</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(36, 41, 46)">${</span><span class="token template-string interpolation constant" style="color:rgb(100, 102, 149)">RABBITMQ_HOST</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token template-string string">/</span><span class="token template-string template-punctuation string">`</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">RABBITMQ_QUEUE</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> process</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">env</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token constant" style="color:rgb(100, 102, 149)">RABBITMQ_QUEUE</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token console class-name" style="color:rgb(227, 98, 9)">console</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">log</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token constant" style="color:rgb(100, 102, 149)">RABBITMQ_CONNECTION_STRING</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(111, 66, 193)">getRandomNumber</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(0, 92, 197)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#e3116c">return</span><span class="token plain"> </span><span class="token known-class-name class-name" style="color:rgb(227, 98, 9)">Math</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">random</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">amqp</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">connect</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token constant" style="color:rgb(100, 102, 149)">RABBITMQ_CONNECTION_STRING</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">then</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token parameter">conn</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(0, 92, 197)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token console class-name" style="color:rgb(227, 98, 9)">console</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">log</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token string">&quot;[ Connection Established ] &quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">toUpperCase</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#e3116c">return</span><span class="token plain"> conn</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">createChannel</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">then</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token parameter">chan</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(0, 92, 197)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#e3116c">return</span><span class="token plain"> chan</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">assertQueue</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token constant" style="color:rgb(100, 102, 149)">RABBITMQ_QUEUE</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        </span><span class="token literal-property property">durable</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(0, 92, 197)">false</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">then</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(0, 92, 197)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        </span><span class="token keyword" style="color:#e3116c">let</span><span class="token plain"> n </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        </span><span class="token keyword" style="color:#e3116c">let</span><span class="token plain"> interval </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">setInterval</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(0, 92, 197)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">          n</span><span class="token operator" style="color:rgb(0, 92, 197)">++</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">          </span><span class="token keyword" style="color:#e3116c">let</span><span class="token plain"> randomNumber </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">getRandomNumber</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">          chan</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">sendToQueue</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            </span><span class="token constant" style="color:rgb(100, 102, 149)">RABBITMQ_QUEUE</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            </span><span class="token maybe-class-name">Buffer</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token keyword module" style="color:#e3116c">from</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">randomNumber</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">toString</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">          </span><span class="token console class-name" style="color:rgb(227, 98, 9)">console</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">log</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">[ Sent:     </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(36, 41, 46)">${</span><span class="token template-string interpolation">randomNumber</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token template-string string"> ] </span><span class="token template-string template-punctuation string">`</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">toUpperCase</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">          </span><span class="token keyword control-flow" style="color:#e3116c">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">n </span><span class="token operator" style="color:rgb(0, 92, 197)">===</span><span class="token plain"> </span><span class="token number">50</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            </span><span class="token function" style="color:rgb(111, 66, 193)">clearInterval</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">interval</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> </span><span class="token number">1500</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token keyword control-flow" style="color:#e3116c">catch</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token parameter">err</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(0, 92, 197)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token console class-name" style="color:rgb(227, 98, 9)">console</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">log</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">err</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span></div></pre>
<p class="Blogpost-module--paragraph--24cce">Now, then, we have two producers that will dump, in total, 100 messages into the queue.</p>
<p class="Blogpost-module--paragraph--24cce">Let&#x27;s now create a consumer for the messages that may do something with the messages.</p>
<pre class="prism-code language-javascript Blogpost-module--codeblock--b46bb" style="color:rgb(36, 41, 46);background-color:#FAFAFA"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token comment" style="color:rgb(106, 153, 85)">//</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// Same declarations as the producer</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">//</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> amqp </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">require</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token string">&quot;amqplib&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">RABBITMQ_HOST</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> process</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">env</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token constant" style="color:rgb(100, 102, 149)">RABBITMQ_HOST</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">RABBITMQ_USER</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> process</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">env</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token constant" style="color:rgb(100, 102, 149)">RABBITMQ_USER</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">RABBITMQ_PASS</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> process</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">env</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token constant" style="color:rgb(100, 102, 149)">RABBITMQ_PASS</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">RABBITMQ_CONNECTION_STRING</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">amqp://</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(36, 41, 46)">${</span><span class="token template-string interpolation constant" style="color:rgb(100, 102, 149)">RABBITMQ_USER</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token template-string string">:</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(36, 41, 46)">${</span><span class="token template-string interpolation constant" style="color:rgb(100, 102, 149)">RABBITMQ_PASS</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token template-string string">@</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(36, 41, 46)">${</span><span class="token template-string interpolation constant" style="color:rgb(100, 102, 149)">RABBITMQ_HOST</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token template-string string">/</span><span class="token template-string template-punctuation string">`</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">RABBITMQ_QUEUE</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> process</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">env</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token constant" style="color:rgb(100, 102, 149)">RABBITMQ_QUEUE</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// Counter for total number of consumer messages</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">let</span><span class="token plain"> consumer_count </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">amqp</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">connect</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token constant" style="color:rgb(100, 102, 149)">RABBITMQ_CONNECTION_STRING</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">then</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token parameter">conn</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(0, 92, 197)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token console class-name" style="color:rgb(227, 98, 9)">console</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">log</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token string">&quot;[ Connection Established ] &quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">toUpperCase</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)">// Create channel</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#e3116c">return</span><span class="token plain"> conn</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">createChannel</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">then</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token parameter">chan</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(0, 92, 197)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)">// Declare the queue to consume</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#e3116c">return</span><span class="token plain"> chan</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">assertQueue</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token constant" style="color:rgb(100, 102, 149)">RABBITMQ_QUEUE</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        </span><span class="token literal-property property">durable</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(0, 92, 197)">false</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">then</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(0, 92, 197)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        </span><span class="token comment" style="color:rgb(106, 153, 85)">//</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        </span><span class="token comment" style="color:rgb(106, 153, 85)">// We can then consume data from a queue</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        </span><span class="token comment" style="color:rgb(106, 153, 85)">//</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        chan</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">consume</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token constant" style="color:rgb(100, 102, 149)">RABBITMQ_QUEUE</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token parameter">message</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(0, 92, 197)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">          </span><span class="token comment" style="color:rgb(106, 153, 85)">//</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">          </span><span class="token comment" style="color:rgb(106, 153, 85)">// Simulate some blocking operation, such as a worker operation</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">          </span><span class="token comment" style="color:rgb(106, 153, 85)">// Not that of course this will be working asynchronously, meaning</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">          </span><span class="token comment" style="color:rgb(106, 153, 85)">// that it DOES NOT handle one request every 2 seconds. It just means</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">          </span><span class="token comment" style="color:rgb(106, 153, 85)">// that each request will take 2 seconds to complete.</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">          </span><span class="token comment" style="color:rgb(106, 153, 85)">// So, essentially, the last output from the consumer should be</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">          </span><span class="token comment" style="color:rgb(106, 153, 85)">// ~2 seconds after the last message pushed into the queue by the producer.</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">          </span><span class="token comment" style="color:rgb(106, 153, 85)">//</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">          </span><span class="token function" style="color:rgb(111, 66, 193)">setTimeout</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(0, 92, 197)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            </span><span class="token keyword control-flow" style="color:#e3116c">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">message </span><span class="token operator" style="color:rgb(0, 92, 197)">!==</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#e3116c">null</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">              </span><span class="token comment" style="color:rgb(106, 153, 85)">// Increment consumer count</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">              consumer_count</span><span class="token operator" style="color:rgb(0, 92, 197)">++</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">              </span><span class="token comment" style="color:rgb(106, 153, 85)">// Log the received value to console</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">              </span><span class="token console class-name" style="color:rgb(227, 98, 9)">console</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">log</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                </span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">[ RECEIVED: </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(36, 41, 46)">${</span><span class="token template-string interpolation">message</span><span class="token template-string interpolation punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token template-string interpolation property-access" style="color:rgb(111, 66, 193)">content</span><span class="token template-string interpolation punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token template-string interpolation method function property-access" style="color:rgb(111, 66, 193)">toString</span><span class="token template-string interpolation punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token template-string interpolation punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token template-string string"> | COUNT: </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(36, 41, 46)">${</span><span class="token template-string interpolation">consumer_count</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token template-string string"> ] </span><span class="token template-string template-punctuation string">`</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">toUpperCase</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">              </span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> </span><span class="token number">2000</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token keyword control-flow" style="color:#e3116c">catch</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token parameter">err</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(0, 92, 197)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token console class-name" style="color:rgb(227, 98, 9)">console</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">log</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">err</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span></div></pre>
<p class="Blogpost-module--paragraph--24cce">To summarize what the consumer is doing:</p>
<ul class="Blogpost-module--ul--7d1eb">
<li class="Blogpost-module--li--5e5a4">Environment variables, connection to the RabbitMQ instance, channel creation, and queue specification remains exactly the same as for the producers.</li>
<li class="Blogpost-module--li--5e5a4">To consume messages from channel, we use the code:</li>
</ul>
<pre class="prism-code language-javascript Blogpost-module--codeblock--b46bb" style="color:rgb(36, 41, 46);background-color:#FAFAFA"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">then</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(0, 92, 197)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)">// consume messages from specific queue</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">	chan</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">consume</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token constant" style="color:rgb(100, 102, 149)">RABBITMQ_QUEUE</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token parameter">message</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(0, 92, 197)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        </span><span class="token comment" style="color:rgb(106, 153, 85)">// do something with the message</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">		</span><span class="token function" style="color:rgb(111, 66, 193)">setTimeout</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(0, 92, 197)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">			</span><span class="token keyword control-flow" style="color:#e3116c">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">message </span><span class="token operator" style="color:rgb(0, 92, 197)">!==</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#e3116c">null</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                </span><span class="token comment" style="color:rgb(106, 153, 85)">// Increment consumer count</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                consumer_count</span><span class="token operator" style="color:rgb(0, 92, 197)">++</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">                </span><span class="token comment" style="color:rgb(106, 153, 85)">// Log the received value to console</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">				</span><span class="token console class-name" style="color:rgb(227, 98, 9)">console</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">log</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">					</span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">[ RECEIVED: </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(36, 41, 46)">${</span><span class="token template-string interpolation">message</span><span class="token template-string interpolation punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token template-string interpolation property-access" style="color:rgb(111, 66, 193)">content</span><span class="token template-string interpolation punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token template-string interpolation method function property-access" style="color:rgb(111, 66, 193)">toString</span><span class="token template-string interpolation punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token template-string interpolation punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token template-string string"> | COUNT: </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(36, 41, 46)">${</span><span class="token template-string interpolation">consumer_count</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token template-string string"> ] </span><span class="token template-string template-punctuation string">`</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">toUpperCase</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">				</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">			</span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">		</span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> </span><span class="token number">2000</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// Wait for two seconds to simulate some blocking operation</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">	</span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span></div></pre>
<p class="Blogpost-module--paragraph--24cce">Something to note here is the fact that we do not use a loop in our consumer. This means that consumer connections work somewhat like websocket connections, whereby the consumer constantly listens on the channel for incoming messages. Whenever the consumer service is free to do work, it reaches into the queue and gets the oldest message (first in queue) and processes it as required. In case there is no message, the consumer will wait on the queue.</p>
<p class="Blogpost-module--paragraph--24cce">To run the app, run</p>
<pre class="prism-code language- Blogpost-module--codeblock--b46bb" style="color:rgb(36, 41, 46);background-color:#FAFAFA"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">docker-compose up</span></div></pre>
<p class="Blogpost-module--paragraph--24cce">Of course it requires you to have docker and docker-compose installed locally. However, NodeJS and RabbitMQ installations are not needed. (<em>Why? Because docker is awesome like that</em>)</p>
<p class="Blogpost-module--paragraph--24cce">Running docker-compose output you&#x27;ll see an output that looks something like this:</p>
<span><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/19713722c49addbd31608de3d9a05fc6/29114/op-1.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 43%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABOklEQVR42pWQ0XKCMBBF+YzWIgESJAkJAqEoap2Rtm+d/v/f3G5iYXyoM/bhzG4WcvfeRHnFkSQJjDVomgZKKZRlGfC91jogpQzVz+fqZx4uBIqiQJZliKS2KPICtrZwXYe+79FR9RfyPIegnzkXoeecL7PbM2NsIVJWQ2QC22YbxPrewRG1tYvDqqqCk9n9XBeHJOyXXB0aQw4FOazhnAvuDM3maLeRvfA8Dwt+l2wo7jURCbZaQqQF6tqEC7thh2EYwsf1Og7v+xc+3m2/RNYkmMZpcNa2LU6nE6bpAkuR/fvcE7xHlEtFThjqpqXIrxj2I/bjgc4NNqVEwtJ/EdmyAF/F6LYVOop9PuwxnY+wagPOYrCXp4dJ42dEWfeGuOyhx3eY4yfc9IXh4xtyd0HWjFgp9zCx7vED8QIFIM71mZQAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Output 1"
        title=""
        src="/static/19713722c49addbd31608de3d9a05fc6/5a190/op-1.png"
        srcset="/static/19713722c49addbd31608de3d9a05fc6/772e8/op-1.png 200w,
/static/19713722c49addbd31608de3d9a05fc6/e17e5/op-1.png 400w,
/static/19713722c49addbd31608de3d9a05fc6/5a190/op-1.png 800w,
/static/19713722c49addbd31608de3d9a05fc6/c1b63/op-1.png 1200w,
/static/19713722c49addbd31608de3d9a05fc6/29007/op-1.png 1600w,
/static/19713722c49addbd31608de3d9a05fc6/29114/op-1.png 1920w"
        sizes="(max-width: 800px) 100vw, 800px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></span>
<p class="Blogpost-module--paragraph--24cce">Eventually, when all of the messages have been processed, there will be no more console logging. The producers do not send any more data into the queue, and the consumer continues waiting on the queue.</p>
<span><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/c9cabefc580e60092e1e1f529c93e04d/29114/op-2.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 24%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAf0lEQVR42qXQXQrDIBhE0WxEbYnma+IvUURQ3P+upsYd2D7M64E7m6YbBz9grUMIAaUU1FphjIFSCpzzpW3XJw1QwfuAlNLEeu9wzoGI1kGigJ3tsM4jxhs5Z7TWfgfPkSyZHMADxpn8FyiVwZu9cF7XyPbzxwfWWk9QCLEEfgH7aI5HjDNa/wAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Output 2"
        title=""
        src="/static/c9cabefc580e60092e1e1f529c93e04d/5a190/op-2.png"
        srcset="/static/c9cabefc580e60092e1e1f529c93e04d/772e8/op-2.png 200w,
/static/c9cabefc580e60092e1e1f529c93e04d/e17e5/op-2.png 400w,
/static/c9cabefc580e60092e1e1f529c93e04d/5a190/op-2.png 800w,
/static/c9cabefc580e60092e1e1f529c93e04d/c1b63/op-2.png 1200w,
/static/c9cabefc580e60092e1e1f529c93e04d/29007/op-2.png 1600w,
/static/c9cabefc580e60092e1e1f529c93e04d/29114/op-2.png 1920w"
        sizes="(max-width: 800px) 100vw, 800px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></span>
<p class="Blogpost-module--paragraph--24cce">If you look hard enough, you&#x27;ll see how the order of messages being sent and being received is perfectly in line, as expected from the queue. Further, we also see that the consumer works on the messages one by one, independent of how the messages arrive, logging a <span class="Blogpost-module--code--7cd1e Blogpost-module--code__light--70872">RECEIVED</span> message exactly every 2 seconds.</p>
<p class="Blogpost-module--paragraph--24cce">That was all for this article. Although I have not discussed complex concepts and strategies used by modern MQ systems like Apache Kafka, such as distributed commit logging and sharding partitioning of queues, you hopefully now have greater insight into what a messaging queue is and can imagine many more use cases where such a system may prove to be useful. Perhaps you could think of how you could integrate an MQ system into your own projects. The principles discussed here should be effectively transferrable to any other MQ system.</p>
<p class="Blogpost-module--paragraph--24cce">That&#x27;s it for now, dear reader. Until next time.</p></div></section><div class="Blog-module--dividerFooter--7a4af"></div><footer class="Blog-module--footer--5b35a">Dakshraj Sharma, 2021</footer></main></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-198807496-1"></script><script>
      
      
      if(true) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-198807496-1', {"send_page_view":false});
      }
      </script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blog/the-what-why-and-how-of-message-queues/";/*]]>*/</script><!-- slice-start id="_gatsby-scripts-1" -->
          <script
            id="gatsby-chunk-mapping"
          >
            window.___chunkMapping="{\"app\":[\"/app-925945d95e0ee4366ca2.js\"],\"component---src-pages-404-jsx\":[\"/component---src-pages-404-jsx-66a81aff0562c2194c36.js\"],\"component---src-pages-about-jsx\":[\"/component---src-pages-about-jsx-857645dcb0df5ae02830.js\"],\"component---src-pages-blog-jsx\":[\"/component---src-pages-blog-jsx-13f111c50df54a2a82e3.js\"],\"component---src-pages-index-jsx\":[\"/component---src-pages-index-jsx-81dc291bfb0bc847c5b6.js\"],\"component---src-pages-reading-jsx\":[\"/component---src-pages-reading-jsx-1e5bf9717aa4834002de.js\"],\"component---src-templates-blogpost-jsx-content-file-path-src-posts-2020-06-06-index-mdx\":[\"/component---src-templates-blogpost-jsx-content-file-path-src-posts-2020-06-06-index-mdx-207c8474bdd38a806feb.js\"],\"component---src-templates-blogpost-jsx-content-file-path-src-posts-2020-06-24-index-mdx\":[\"/component---src-templates-blogpost-jsx-content-file-path-src-posts-2020-06-24-index-mdx-cca0e4f8cf5ab1a2c6bc.js\"],\"component---src-templates-blogpost-jsx-content-file-path-src-posts-2020-09-15-index-mdx\":[\"/component---src-templates-blogpost-jsx-content-file-path-src-posts-2020-09-15-index-mdx-a129480a368356fc0401.js\"],\"component---src-templates-blogpost-jsx-content-file-path-src-posts-2021-03-21-index-mdx\":[\"/component---src-templates-blogpost-jsx-content-file-path-src-posts-2021-03-21-index-mdx-f5244f979db75c2ab064.js\"],\"component---src-templates-blogpost-jsx-content-file-path-src-posts-2021-05-29-index-mdx\":[\"/component---src-templates-blogpost-jsx-content-file-path-src-posts-2021-05-29-index-mdx-56c977c6b75846df850a.js\"]}";
          </script>
        <script>window.___webpackCompilationHash="bd32080e910dfbc05a39";</script><script src="/webpack-runtime-8472e3fcfebac6528dea.js" async></script><script src="/framework-e59175b5fc4b364bb443.js" async></script><script src="/cb355538-80720c15979fe7610973.js" async></script><script src="/app-925945d95e0ee4366ca2.js" async></script><!-- slice-end id="_gatsby-scripts-1" --></body></html>